<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>MYC Blog</title>
    <description>Yancan Mao, a 2nd year Ph.D. Student in National University of Singapore</description>
    <link>http://localhost:4000/</link>
    <atom:link href="http://localhost:4000/feed.xml" rel="self" type="application/rss+xml" />
    <pubDate>Wed, 25 Nov 2020 20:47:59 +0800</pubDate>
    <lastBuildDate>Wed, 25 Nov 2020 20:47:59 +0800</lastBuildDate>
    <generator>Jekyll v3.9.0</generator>
    
      <item>
        <title>Internet Architecture</title>
        <description>&lt;h2 id=&quot;internet-architecture&quot;&gt;Internet Architecture&lt;/h2&gt;

&lt;h4 id=&quot;performance&quot;&gt;performance&lt;/h4&gt;

&lt;p&gt;&lt;strong&gt;Network Performance Metrics&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Link Rate/Bandwidth/Capacity&lt;/p&gt;

&lt;p&gt;Throughput(successful message delivery)&lt;/p&gt;

&lt;p&gt;End-to-end delay&lt;/p&gt;

&lt;p&gt;Response time&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Packet switching versus circuit switching:&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;circuit-switching 10 users. reserved resources&lt;/li&gt;
  &lt;li&gt;packet switching: 35 users. on-demand allocation&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;Little‚Äôs Law: $L = \lambda W$&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Arrival rate: ùúÜ&lt;/p&gt;

&lt;p&gt;# of customers/packets in the system: ùêø&lt;/p&gt;

&lt;p&gt;Sojourn time ùëä&lt;/p&gt;

&lt;h4 id=&quot;queueing&quot;&gt;Queueing&lt;/h4&gt;

&lt;p&gt;independent and identically distributed(i.i.d)&lt;/p&gt;

&lt;p&gt;random variable (r.v.)&lt;/p&gt;

&lt;p&gt;probability density function&lt;/p&gt;

&lt;p&gt;exponential distribution: $F(x) = P{T \le x} = 1 - e^{- \lambda x}$ or $F\overline (x) = P{T &amp;gt; x} = e^{- \lambda x}$&lt;/p&gt;

&lt;table&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Memoryless property: $P{T&amp;gt;s+t&lt;/td&gt;
      &lt;td&gt;T &amp;gt; s} = P{T&amp;gt;t}$&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;strong&gt;M/M/1 Model&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;percentage of time that the ‚Äúserver‚Äù is busy, probability a random observation finds server busy&lt;/p&gt;

&lt;p&gt;Utilization: $\rho = \frac{\lambda}{\mu}$&lt;/p&gt;

&lt;p&gt;Percentage of time that exactly $i$ packets or customer in the system, i.e., packets or customers in the system, i.e., server + queue.&lt;/p&gt;

&lt;p&gt;MM1 system: $\pi_{i} = P]{L=i}=\rho^i(1-\rho)$&lt;/p&gt;

&lt;p&gt;Average # of packet in the system: $E(L) = \frac{\rho}{1-\rho}$&lt;/p&gt;

&lt;p&gt;Average sojourn time of packets: $E(W) = \frac{1}{\mu - \lambda}$&lt;/p&gt;

&lt;p&gt;Average # of packets in the queue $E(Q) = \frac{\rho^2}{1-\rho}$&lt;/p&gt;

&lt;p&gt;Avg. queueing delay of packets $E(D) = E(W) - \frac{1}{\mu}$&lt;/p&gt;

&lt;p&gt;the joint probability: $P{L_1= j, L_2 = k} = P{L_1 = j}P{L_2 = k} = \rho_1^j(1-\rho)\rho_2^k(1-\rho_2)$&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Jackson Network&lt;/strong&gt;: $\lambda_i = r_i+\sum_{j=1}^{n} \lambda_j P_{ji}$&lt;/p&gt;

&lt;h4 id=&quot;resource-allocation&quot;&gt;Resource Allocation&lt;/h4&gt;

&lt;p&gt;reason: Internet provides best-effort service&lt;/p&gt;

&lt;p&gt;Solution: allocate different amount resource to different application flows.&lt;/p&gt;

&lt;p&gt;Fairness: Equal share of resources&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Max-Min Fairness&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Max-Min Fair: distributed mechanisms are needed.&lt;/p&gt;

&lt;p&gt;Generalized Process Sharing (GPS)&lt;/p&gt;

&lt;p&gt;Weighted Fair Queueing (WFQ): packet-based and work-conserving&lt;/p&gt;

&lt;p&gt;Virtual Departure Time&lt;/p&gt;

&lt;p&gt;virtual finish time&lt;/p&gt;

&lt;h4 id=&quot;software-defined-networking&quot;&gt;Software Defined Networking&lt;/h4&gt;

&lt;p&gt;network management&lt;/p&gt;

&lt;p&gt;networks are still notoriously hard to manage&lt;/p&gt;

&lt;p&gt;Data Plane: processing and delivery of packets&lt;/p&gt;

&lt;p&gt;Control Plane: establishing the state in routers&lt;/p&gt;

&lt;p&gt;Benefits of Separation:&lt;/p&gt;

&lt;p&gt;Independent evolution and development&lt;/p&gt;

&lt;p&gt;Control from high-level software program&lt;/p&gt;

&lt;p&gt;Benefits of Centralization:&lt;/p&gt;

&lt;p&gt;Centralized decisions are easier to make&lt;/p&gt;

&lt;p&gt;Logically vs. physically centralized: SDN logically centralized&lt;/p&gt;

&lt;p&gt;modularize the network control problem.&lt;/p&gt;

&lt;p&gt;network virtualization: SDN case study&lt;/p&gt;

&lt;h4 id=&quot;bgp&quot;&gt;BGP&lt;/h4&gt;

&lt;p&gt;AS: Autonomous System&lt;/p&gt;

&lt;p&gt;Link state algorithm: all routers have complete topology, link cost info, Open Shortest Path First (OSPF)&lt;/p&gt;

&lt;p&gt;Distance vector algorithm: router knows neighbors, link costs , Routing Information Protocol (RIP)&lt;/p&gt;

&lt;p&gt;Distance Vector (DV) approach&lt;/p&gt;

&lt;p&gt;Path-Vector(PV) Routing&lt;/p&gt;

&lt;p&gt;Border Gateway Protocol (BGP): the de facto inter-domain routing protocol&lt;/p&gt;
</description>
        <pubDate>Mon, 03 Dec 2018 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2018/12/03/internet-architecture/</link>
        <guid isPermaLink="true">http://localhost:4000/2018/12/03/internet-architecture/</guid>
        
        <category>Â≠¶‰π†</category>
        
        <category>ÊäÄÊúØ</category>
        
        
      </item>
    
      <item>
        <title>Distributed Database</title>
        <description>&lt;h2 id=&quot;distributed-database&quot;&gt;Distributed Database&lt;/h2&gt;

&lt;h4 id=&quot;distributed-database-design-fragmentation&quot;&gt;Distributed Database design: Fragmentation&lt;/h4&gt;

&lt;p&gt;Data fragmentation: Horizontal fragmentation, Vertical fragmentation, Hybrid fragmentation&lt;/p&gt;

&lt;h4 id=&quot;distributed-query-processing&quot;&gt;Distributed Query Processing&lt;/h4&gt;

&lt;p&gt;Join Strategies: Collocated Join(0), Directed Join(size(R)), Broadcast Join((n ‚àí 1) √ó size(R)), Repartitioned Join(size(R) + size(S))&lt;/p&gt;

&lt;h4 id=&quot;storage--indexing&quot;&gt;Storage &amp;amp; Indexing&lt;/h4&gt;

&lt;p&gt;LSM = Log-Structured Merge: Targeted at write-intensive workloads&lt;/p&gt;

&lt;p&gt;Compaction Strategies: Size-tiered Compaction Strategy (STCS)&lt;/p&gt;

&lt;p&gt;Leveled Compaction Strategy (LCS): F = compaction factor, Compact when $Size(L) &amp;gt; F^L$&lt;/p&gt;

&lt;p&gt;Optimizing SSTable Search: Sparse Index(find block in table), Bloom Filter(find key in block)&lt;/p&gt;

&lt;p&gt;Indexing: Local Indexing, Global Indexing&lt;/p&gt;

&lt;h4 id=&quot;distributed-commit-protocols&quot;&gt;Distributed Commit Protocols&lt;/h4&gt;

&lt;p&gt;ACID properties: Atomicity, Consistency, Isolation, Durability&lt;/p&gt;

&lt;p&gt;Xact failures, System failures, Media failures&lt;/p&gt;

&lt;p&gt;Transaction originating site ,Transaction coordinator (TC), Transaction Manager (TM)&lt;/p&gt;

&lt;p&gt;Commit protocol: 2PC, 3PC (Before sends messages, writes log records, reflect its state.)&lt;/p&gt;

&lt;p&gt;2PC: prepare(coordinator see global result), commit. (block)&lt;/p&gt;

&lt;p&gt;3PC: prepare, precommit(inform others global result), commit. (non-block)&lt;/p&gt;

&lt;p&gt;Recovery protocol: restarted servers do things.&lt;/p&gt;

&lt;p&gt;Termination protocol: timer runs out will invoke termination protocol(either abort or resend its msg)&lt;/p&gt;

&lt;p&gt;Cooperative Termination (CT) Protocol: coordinator fail, one P ask all other Ps for final state.&lt;/p&gt;

&lt;p&gt;New Coordinator Termination Protocol: a new coordinator, State-request message.&lt;/p&gt;

&lt;h4 id=&quot;distributed-concurrency-control&quot;&gt;Distributed Concurrency Control&lt;/h4&gt;

&lt;p&gt;view equivalent, view serializable schedule&lt;/p&gt;

&lt;p&gt;conflict equivalent, conflict serializable schedule $\to$ view serializable schedule&lt;/p&gt;

&lt;p&gt;Lock-Based Concurrency Control:&lt;/p&gt;

&lt;p&gt;Two Phase Locking (2PL) Protocol (conflict serializable)&lt;/p&gt;

&lt;p&gt;Strict Two Phase Locking (S2PL) (conflict serializable &amp;amp; recoverable)&lt;/p&gt;

&lt;p&gt;Multiversion Concurrency Control: not blocked&lt;/p&gt;

&lt;p&gt;multiversion view equivalent (S $\equiv_{mv}$ S‚Ä≤): have the same set of read-from relationships&lt;/p&gt;

&lt;p&gt;monoversion schedule: read most recently created version&lt;/p&gt;

&lt;p&gt;serial monoversion schedule: if it is a serial schedule&lt;/p&gt;

&lt;p&gt;multiversion view serializable schedule (MVSS): exists serial monoversion schedule&lt;/p&gt;

&lt;p&gt;view serializable schedule (VSS) $\to$ multiversion view serializable schedule
(MVSS)&lt;/p&gt;

&lt;p&gt;Snapshot isolation:&lt;/p&gt;

&lt;p&gt;Concurrent Update Property: First Committer Wins (FCW) Rule, First Updater Wins (FUW) Rule&lt;/p&gt;

&lt;p&gt;Serializable Snapshot Isolation (SSI) Protocol: Detects non-serializable schedules&lt;/p&gt;

&lt;p&gt;Concurrency Control Protocols:&lt;/p&gt;

&lt;p&gt;Distributed Lock-based Protocols: Centralized 2PL (C2PL), Distributed 2PL (D2PL)
Centralized Snapshot Isolation (CSI): Centralized Coordinator (CC)&lt;/p&gt;

&lt;h4 id=&quot;data-replication&quot;&gt;Data Replication&lt;/h4&gt;

&lt;p&gt;One-copy database = non-replicated database&lt;/p&gt;

&lt;p&gt;one-copy serializable (1SR): the same effect as executes on a one-copy database&lt;/p&gt;

&lt;p&gt;mutually consistency: all the replicas have the identical values, strong consis, weak consis.&lt;/p&gt;

&lt;p&gt;Replicated data (RD) schedules, One-copy (1C) schedules&lt;/p&gt;

&lt;p&gt;Statement-based replication: send updates to replicas&lt;/p&gt;

&lt;p&gt;Replication Protocols: Eager(Read-One-Write-All (ROWA) protocols), Lazy, Centralized, Distributed&lt;/p&gt;

&lt;p&gt;Lazy Distributed Protocol: Reconciliation of Inconsistent Updates: Last-Writer-Wins heuristic&lt;/p&gt;

&lt;h4 id=&quot;replicated-data-consistency&quot;&gt;Replicated Data Consistency&lt;/h4&gt;

&lt;p&gt;Consistent prefix and monotonic reads&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;C:\Users\Yancan\AppData\Roaming\Typora\typora-user-images\1543232060813.png&quot; alt=&quot;1543232060813&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;distributed-query-optimization&quot;&gt;Distributed Query Optimization&lt;/h4&gt;

&lt;p&gt;$Communication \ cost = T_{MSG}√ó (number \ of \ messages) + T_{TR}√ó (size \ of \ transferred \ data)$&lt;/p&gt;

&lt;p&gt;Selectivity Factors&lt;/p&gt;

&lt;p&gt;$SF_{SJ}(S.A) $= semijoin selectivity factor of S.A&lt;/p&gt;

&lt;table&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;$SF_{SJ}(S.A)  = \frac{card(œÄA(S))}{&lt;/td&gt;
      &lt;td&gt;domain(A)&lt;/td&gt;
      &lt;td&gt;} $&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;SDD-1 Algorithm:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;For each relation, apply local reductions (i.e., selections, projections)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;Iteratively select the most beneficial semijoin until none is applicable&lt;/li&gt;
  &lt;li&gt;Determine assembly site to compute joins&lt;/li&gt;
  &lt;li&gt;Post-optimization: eliminate unnecessary semijoin reductions&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;$card(R‚Ä≤) = card(R) √ó SF_{SJ} (S.A)$&lt;/p&gt;

&lt;p&gt;$size(R‚Ä≤) = card(R‚Ä≤) √ó length(R)$&lt;/p&gt;

&lt;p&gt;Full Reducer, Ear Reduction&lt;/p&gt;

&lt;table&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;semijoin&lt;/td&gt;
      &lt;td&gt;cost&lt;/td&gt;
      &lt;td&gt;benefit&lt;/td&gt;
      &lt;td&gt;benefit-cost&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;table&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;relation X&lt;/td&gt;
      &lt;td&gt;size(X)	   attribute X.A&lt;/td&gt;
      &lt;td&gt;SF_sj(X.A)&lt;/td&gt;
      &lt;td&gt;size(\piA(X))&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
</description>
        <pubDate>Tue, 27 Nov 2018 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2018/11/27/distributed-database/</link>
        <guid isPermaLink="true">http://localhost:4000/2018/11/27/distributed-database/</guid>
        
        <category>Â≠¶‰π†</category>
        
        <category>ÊäÄÊúØ</category>
        
        
      </item>
    
      <item>
        <title>Distributed System</title>
        <description>&lt;h2 id=&quot;distributed-system-skeleton&quot;&gt;Distributed System Skeleton&lt;/h2&gt;

&lt;h4 id=&quot;lecture2&quot;&gt;lecture2&lt;/h4&gt;

&lt;p&gt;OSI model&lt;/p&gt;

&lt;p&gt;RPC goal: Simple. non-blocking RPC&lt;/p&gt;

&lt;p&gt;MultiCast: Application-Level Multicast(p2p), IP Multicast&lt;/p&gt;

&lt;p&gt;Gossip: O(logn) Gossip aggregation: sum, average, min‚Ä¶ O(logn)&lt;/p&gt;

&lt;h4 id=&quot;lecture3&quot;&gt;lecture3&lt;/h4&gt;

&lt;p&gt;Processes are expensive: creation cost, context switch, inter-process communication(all of them will involve OS) ‚Äì same app no need isolation.&lt;/p&gt;

&lt;p&gt;Threads are cheap: three aspect not via OS. user-level threads, kernel-level threads, LWP. block problem(non-blocking, upcall).&lt;/p&gt;

&lt;p&gt;Thread pool: used in Dist sys, pre request a pool of threads, dispatch threads for incoming jobs, optimize thread creation cost, more stable against perk load.&lt;/p&gt;

&lt;p&gt;Event driven Architecture: problem: single Thread maintain all CPU state information of each request.&lt;/p&gt;

&lt;p&gt;Event driven: highly specialized thread package, every request has its own thread package, no need to maintain other requests‚Äô CPU state, context switch will faster.&lt;/p&gt;

&lt;p&gt;stateful-stateless: try to be stateless.&lt;/p&gt;

&lt;p&gt;Server Cluster: tier architecture.&lt;/p&gt;

&lt;h4 id=&quot;lecture4&quot;&gt;lecture4&lt;/h4&gt;

&lt;p&gt;Name System: Merge name spaces: new root node, mounting.&lt;/p&gt;

&lt;p&gt;Simple Naming: resolve a name: broad cast, forwarding pointers, home-based approach.&lt;/p&gt;

&lt;p&gt;DNS.&lt;/p&gt;

&lt;h4 id=&quot;lecture5&quot;&gt;lecture5&lt;/h4&gt;

&lt;p&gt;Physical Clock sync motivation: Clock rate drift, clock drift&lt;/p&gt;

&lt;p&gt;Physical clock sync solve problem: clock drift&lt;/p&gt;

&lt;p&gt;Cristian‚Äôs protocol assumption: same request and reply delay.&lt;/p&gt;

&lt;p&gt;Network Time protocol: sync with multiple servers, pick smallest d. delay minimum. server need UTC&lt;/p&gt;

&lt;p&gt;The Berkeley alg: no accurate time all servers.&lt;/p&gt;

&lt;p&gt;Software clock: no external clocks. infer ordering of events.&lt;/p&gt;

&lt;p&gt;Software clock assumption: atomic is important.&lt;/p&gt;

&lt;p&gt;logical clock: clock 1 &amp;lt; 5 !=&amp;gt; event 1 happens before 5.&lt;/p&gt;

&lt;p&gt;vector clock: clock 1 &amp;lt; 5 =&amp;gt; event 1 happens before 5.&lt;/p&gt;

&lt;p&gt;mutual exclusion: guarantee atomic? lock manager election&lt;/p&gt;

&lt;p&gt;Token based approach: use a leader server&lt;/p&gt;

&lt;p&gt;Voting: quorum vote to get lock&lt;/p&gt;

&lt;p&gt;Leader Election:&lt;/p&gt;

&lt;h4 id=&quot;lecture6&quot;&gt;lecture6&lt;/h4&gt;

&lt;p&gt;&lt;strong&gt;Consistency model:&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Sequential consistency: all processors execute in the same order, sequence may not the same with global time order.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;linearizability consistency: sequential consistency and time follow global time.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Eventual consistency: all replica will eventually be the same, so as we see, final state should be the same.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Continuous Consistency: one model named TACT, eventual consistency always be ensured&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;ul&gt;
      &lt;li&gt;final image of continuous consistency: numerical error, order error, temporal error.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;Consistency protocol:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;linearizability/sequential consistency protocol:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;primary-based protocol: all request handled by primary, backup just replicate and read. read once write all.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;ul&gt;
      &lt;li&gt;app uses primary-based protocol: Software Distributed Shared Memory&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;ul&gt;
      &lt;li&gt;failure dealing of primary-based protocol: lease of replica, backup kill itself if no leases.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Replicated State Machine Protocol: read/write majority. instruction of each node should be the same.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Eventual Consistency protocol:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;The Anti-entropy protocol: write/read all, instructions execute in every node, apply cmd in the same order is important.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;ul&gt;
      &lt;li&gt;keep cmds the same order: logical clock, happen-before, Committed and Tentative Write.&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;ul&gt;
      &lt;li&gt;how to find committed and tentative write: use a sequencer to identify. (A,2,1)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Continuous Consistency protocol:(only detection, and alg I assume it is black box)&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Temporal Error TACT: real-time vector clock, compute TE according to curtime - vetor x_i&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Numerical Error TACT: has a global NE stats server to compute the total NE.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Order Error TACT: number of Tentative write is Order Error, detect and use normal alg to solve it.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Replica Replacement: NP hard, global view of info.&lt;/p&gt;

&lt;h4 id=&quot;lecture7&quot;&gt;lecture7&lt;/h4&gt;

&lt;p&gt;Nodes Failure model&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Crash Failure&lt;/li&gt;
  &lt;li&gt;Byzantine Failure&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Communication channels failure: no failure or unreliable(drop msg)&lt;/p&gt;

&lt;p&gt;Timing model&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Sync model: msg delay is bounded, node speed guarantee, accurate failure detection.&lt;/li&gt;
  &lt;li&gt;Async model: msg delay is not bounded, node speed is not guarantee.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Distributed Consensus: failure-free: vote, xact commit, write ordering.&lt;/p&gt;

&lt;p&gt;under failure: Node Crash/Byzantine, channels unreliable, sync/async.&lt;/p&gt;

&lt;p&gt;termination, agreement&lt;/p&gt;

&lt;h4 id=&quot;lecture8&quot;&gt;lecture8&lt;/h4&gt;

&lt;p&gt;p2p:&lt;/p&gt;

&lt;p&gt;unstructured file sharing: central directory server, super-peers, flooding flat p2p topology, random walks flat p2p topology.&lt;/p&gt;

&lt;p&gt;structured file sharing: DHT&lt;/p&gt;
</description>
        <pubDate>Thu, 15 Nov 2018 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2018/11/15/distributed-system/</link>
        <guid isPermaLink="true">http://localhost:4000/2018/11/15/distributed-system/</guid>
        
        <category>Â≠¶‰π†</category>
        
        <category>ÊäÄÊúØ</category>
        
        
      </item>
    
      <item>
        <title>JavaÁü•ËØÜÊê¨Ëøê</title>
        <description>&lt;h2 id=&quot;Ê≥õÂûã&quot;&gt;Ê≥õÂûã&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://www.jianshu.com/p/95f349258afb&quot;&gt;https://www.jianshu.com/p/95f349258afb&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Ôºü&lt;/strong&gt; Ë°®Á§∫‰∏çÁ°ÆÂÆöÁöÑjavaÁ±ªÂûã&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;T (type)&lt;/strong&gt; Ë°®Á§∫ÂÖ∑‰ΩìÁöÑ‰∏Ä‰∏™javaÁ±ªÂûã&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;K V (key value)&lt;/strong&gt; ÂàÜÂà´‰ª£Ë°®javaÈîÆÂÄº‰∏≠ÁöÑKey Value&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;E (element)&lt;/strong&gt; ‰ª£Ë°®Element&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;static-ÂÖ≥ÈîÆÂ≠ó&quot;&gt;static ÂÖ≥ÈîÆÂ≠ó&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://www.cnblogs.com/dolphin0520/p/3799052.html&quot;&gt;https://www.cnblogs.com/dolphin0520/p/3799052.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Âú®„ÄäJavaÁºñÁ®ãÊÄùÊÉ≥„ÄãP86È°µÊúâËøôÊ†∑‰∏ÄÊÆµËØùÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;‚ÄústaticÊñπÊ≥ïÂ∞±ÊòØÊ≤°ÊúâthisÁöÑÊñπÊ≥ï„ÄÇÂú®staticÊñπÊ≥ïÂÜÖÈÉ®‰∏çËÉΩË∞ÉÁî®ÈùûÈùôÊÄÅÊñπÊ≥ïÔºåÂèçËøáÊù•ÊòØÂèØ‰ª•ÁöÑ„ÄÇËÄå‰∏îÂèØ‰ª•Âú®Ê≤°ÊúâÂàõÂª∫‰ªª‰ΩïÂØπË±°ÁöÑÂâçÊèê‰∏ãÔºå‰ªÖ‰ªÖÈÄöËøáÁ±ªÊú¨Ë∫´Êù•Ë∞ÉÁî®staticÊñπÊ≥ï„ÄÇËøôÂÆûÈôÖ‰∏äÊ≠£ÊòØstaticÊñπÊ≥ïÁöÑ‰∏ªË¶ÅÁî®ÈÄî„ÄÇ‚Äù&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ÁÆÄË®Ä‰πãÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;staticÁöÑÁî®Â§ÑÂ∞±ÊòØÊñπ‰æøÂú®Ê≤°ÊúâÂàõÂª∫ÂØπË±°ÁöÑÊÉÖÂÜµ‰∏ãÊù•ËøõË°åË∞ÉÁî®ÔºàÊñπÊ≥ï/ÂèòÈáèÔºâ„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Ë¢´staticÂÖ≥ÈîÆÂ≠ó‰øÆÈ•∞ÁöÑÊñπÊ≥ïÊàñËÄÖÂèòÈáè‰∏çÈúÄË¶Å‰æùËµñ‰∫éÂØπË±°Êù•ËøõË°åËÆøÈóÆÔºåÂè™Ë¶ÅÁ±ªË¢´Âä†ËΩΩ‰∫ÜÔºåÂ∞±ÂèØ‰ª•ÈÄöËøáÁ±ªÂêçÂéªËøõË°åËÆøÈóÆ„ÄÇ&lt;/p&gt;

&lt;p&gt;staticÂèØ‰ª•Áî®Êù•‰øÆÈ•∞Á±ªÁöÑÊàêÂëòÊñπÊ≥ï„ÄÅÁ±ªÁöÑÊàêÂëòÂèòÈáèÔºåÂè¶Â§ñÂèØ‰ª•ÁºñÂÜôstatic‰ª£Á†ÅÂùóÊù•&lt;strong&gt;‰ºòÂåñÁ®ãÂ∫èÊÄßËÉΩ&lt;/strong&gt;„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;Ê≥®ÊÑèÁÇπ&quot;&gt;Ê≥®ÊÑèÁÇπ&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;ÈùôÊÄÅ&lt;/strong&gt;ÊñπÊ≥ï‰∏≠&lt;strong&gt;‰∏çËÉΩ&lt;/strong&gt;ËÆøÈóÆ&lt;strong&gt;ÈùûÈùôÊÄÅ&lt;/strong&gt;ÊàêÂëòÊñπÊ≥ïÂíåÈùûÈùôÊÄÅÊàêÂëòÂèòÈáèÔºå &lt;strong&gt;ÈùûÈùôÊÄÅ&lt;/strong&gt;ÊàêÂëòÊñπÊ≥ï‰∏≠ÊòØ&lt;strong&gt;ÂèØ‰ª•ËÆøÈóÆ&lt;/strong&gt;ÈùôÊÄÅÊàêÂëòÊñπÊ≥ï/ÂèòÈáè&lt;/li&gt;
  &lt;li&gt;ÈùôÊÄÅÂèòÈáèË¢´ÊâÄÊúâÁöÑÂØπË±°ÊâÄÂÖ±‰∫´ÔºåÂÜÖÂ≠ò‰∏≠Âè™Êúâ‰∏Ä‰∏™ÂâØÊú¨ÔºåÂΩì‰∏î‰ªÖÂΩìÂú®Á±ªÂàùÊ¨°Âä†ËΩΩÊó∂‰ºöË¢´ÂàùÂßãÂåñ„ÄÇ&lt;/li&gt;
  &lt;li&gt;ÊØîËæÉÂÖ≥ÈîÆÁöÑ‰ΩúÁî®ÔºåÁî®Êù•ÂΩ¢ÊàêÈùôÊÄÅ‰ª£Á†ÅÂùó‰ª•‰ºòÂåñÁ®ãÂ∫èÊÄßËÉΩÔºåÂæàÂ§öÊó∂ÂÄô‰ºöÂ∞Ü‰∏Ä‰∫õÂè™ÈúÄË¶ÅËøõË°å‰∏ÄÊ¨°ÁöÑÂàùÂßãÂåñÊìç‰ΩúÈÉΩÊîæÂú®static‰ª£Á†ÅÂùó‰∏≠ËøõË°å„ÄÇ(Ëøô‰∏™Â∞±ÂÖ∑‰ΩìÁöÑÊÉÖÂÜµÂÖ∑‰ΩìÁöÑÂÆûÁé∞ÂêßÔºåÁõÆÂâçÊù•ËØ¥ÈÉΩÊòØË∑üÁùÄÈúÄÊ±ÇËµ∞ÁöÑ)&lt;/li&gt;
  &lt;li&gt;staticÂÖ≥ÈîÆÂ≠óÂπ∂‰∏ç‰ºöÊîπÂèòÂèòÈáèÂíåÊñπÊ≥ïÁöÑËÆøÈóÆÊùÉÈôê„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;final-ÂÖ≥ÈîÆÂ≠ó&quot;&gt;final ÂÖ≥ÈîÆÂ≠ó&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://www.cnblogs.com/dolphin0520/p/3736238.html&quot;&gt;https://www.cnblogs.com/dolphin0520/p/3736238.html&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;‰ΩúÁî®&quot;&gt;‰ΩúÁî®&lt;/h3&gt;

&lt;h4 id=&quot;1-‰øÆÈ•∞Á±ªË°®ÊòéËøô‰∏™Á±ª‰∏çËÉΩË¢´ÁªßÊâø&quot;&gt;1. ‰øÆÈ•∞Á±ªÔºöË°®ÊòéËøô‰∏™Á±ª‰∏çËÉΩË¢´ÁªßÊâø„ÄÇ&lt;/h4&gt;

&lt;p&gt;Âú®‰ΩøÁî®final‰øÆÈ•∞Á±ªÁöÑÊó∂ÂÄôÔºåË¶ÅÊ≥®ÊÑèË∞®ÊÖéÈÄâÊã©ÔºåÈô§ÈùûËøô‰∏™Á±ªÁúüÁöÑÂú®‰ª•Âêé‰∏ç‰ºöÁî®Êù•ÁªßÊâøÊàñËÄÖÂá∫‰∫éÂÆâÂÖ®ÁöÑËÄÉËôëÔºåÂ∞ΩÈáè‰∏çË¶ÅÂ∞ÜÁ±ªËÆæËÆ°‰∏∫finalÁ±ª„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;2-‰øÆÈ•∞ÊñπÊ≥ï&quot;&gt;2. ‰øÆÈ•∞ÊñπÊ≥ï&lt;/h4&gt;

&lt;p&gt;‰∏ãÈù¢ËøôÊÆµËØùÊëòËá™„ÄäJavaÁºñÁ®ãÊÄùÊÉ≥„ÄãÁ¨¨ÂõõÁâàÁ¨¨143È°µÔºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;‚Äú‰ΩøÁî®finalÊñπÊ≥ïÁöÑÂéüÂõ†Êúâ‰∏§‰∏™„ÄÇÁ¨¨‰∏Ä‰∏™ÂéüÂõ†ÊòØÊääÊñπÊ≥ïÈîÅÂÆöÔºå‰ª•Èò≤‰ªª‰ΩïÁªßÊâøÁ±ª‰øÆÊîπÂÆÉÁöÑÂê´‰πâÔºõÁ¨¨‰∫å‰∏™ÂéüÂõ†ÊòØÊïàÁéá„ÄÇÂú®Êó©ÊúüÁöÑJavaÂÆûÁé∞ÁâàÊú¨‰∏≠Ôºå‰ºöÂ∞ÜfinalÊñπÊ≥ïËΩ¨‰∏∫ÂÜÖÂµåË∞ÉÁî®„ÄÇ‰ΩÜÊòØÂ¶ÇÊûúÊñπÊ≥ïËøá‰∫éÂ∫ûÂ§ßÔºåÂèØËÉΩÁúã‰∏çÂà∞ÂÜÖÂµåË∞ÉÁî®Â∏¶Êù•ÁöÑ‰ªª‰ΩïÊÄßËÉΩÊèêÂçá„ÄÇÂú®ÊúÄËøëÁöÑJavaÁâàÊú¨‰∏≠Ôºå&lt;strong&gt;‰∏çÈúÄË¶Å&lt;/strong&gt;‰ΩøÁî®finalÊñπÊ≥ïËøõË°åËøô‰∫õ‰ºòÂåñ‰∫Ü„ÄÇ‚Äú&lt;/li&gt;
  &lt;li&gt;Á±ªÁöÑprivateÊñπÊ≥ï‰ºöÈöêÂºèÂú∞Ë¢´ÊåáÂÆö‰∏∫finalÊñπÊ≥ï„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;3-‰øÆÈ•∞ÂèòÈáè‰øÆÈ•∞ÂèòÈáèÊòØfinalÁî®ÂæóÊúÄÂ§öÁöÑÂú∞Êñπ&quot;&gt;3. ‰øÆÈ•∞ÂèòÈáèÔºö‰øÆÈ•∞ÂèòÈáèÊòØfinalÁî®ÂæóÊúÄÂ§öÁöÑÂú∞Êñπ&lt;/h4&gt;

&lt;p&gt;ÂØπ‰∫é‰∏Ä‰∏™finalÂèòÈáèÔºåÂ¶ÇÊûúÊòØÂü∫Êú¨Êï∞ÊçÆÁ±ªÂûãÁöÑÂèòÈáèÔºåÂàôÂÖ∂Êï∞ÂÄº‰∏ÄÊó¶Âú®ÂàùÂßãÂåñ‰πãÂêé‰æø‰∏çËÉΩÊõ¥ÊîπÔºõÂ¶ÇÊûúÊòØÂºïÁî®Á±ªÂûãÁöÑÂèòÈáèÔºåÂàôÂú®ÂØπÂÖ∂ÂàùÂßãÂåñ‰πãÂêé‰æø‰∏çËÉΩÂÜçËÆ©ÂÖ∂ÊåáÂêëÂè¶‰∏Ä‰∏™ÂØπË±°„ÄÇ&lt;/p&gt;

&lt;h2 id=&quot;java-ÂÖ≥ÈîÆÂ≠ó&quot;&gt;Java ÂÖ≥ÈîÆÂ≠ó&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://www.cnblogs.com/AloneZ/p/java1.html&quot;&gt;https://www.cnblogs.com/AloneZ/p/java1.html&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;Á±ªÊñπÊ≥ïÂíåÂèòÈáè‰øÆÈ•∞Á¨¶&quot;&gt;Á±ª„ÄÅÊñπÊ≥ïÂíåÂèòÈáè‰øÆÈ•∞Á¨¶&lt;/h3&gt;

&lt;h4 id=&quot;1-abstract-Â£∞ÊòéÊäΩË±°&quot;&gt;1) abstract Â£∞ÊòéÊäΩË±°&lt;/h4&gt;

&lt;p&gt;abstractÂÖ≥ÈîÆÂ≠óÂèØ‰ª•‰øÆÊîπÁ±ªÊàñÊñπÊ≥ï„ÄÇabstractÁ±ªÂèØ‰ª•Êâ©Â±ïÔºàÂ¢ûÂä†Â≠êÁ±ªÔºâÔºå‰ΩÜ‰∏çËÉΩÁõ¥Êé•ÂÆû‰æãÂåñ„ÄÇabstractÊñπÊ≥ï‰∏çÂú®Â£∞ÊòéÂÆÉÁöÑÁ±ª‰∏≠ÂÆûÁé∞Ôºå‰ΩÜÂøÖÈ°ªÂú®Êüê‰∏™Â≠êÁ±ª‰∏≠ÈáçÂÜô„ÄÇÈááÁî® abstractÊñπÊ≥ïÁöÑÁ±ªÊú¨Êù•Â∞±ÊòØÊäΩË±°Á±ªÔºåÂπ∂‰∏îÂøÖÈ°ªÂ£∞Êòé‰∏∫abstract„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;2-classÁ±ª&quot;&gt;2) classÁ±ª&lt;/h4&gt;

&lt;p&gt;class ÂÖ≥ÈîÆÂ≠óÁî®Êù•Â£∞ÊòéÊñ∞ÁöÑ &lt;a href=&quot;http://lib.csdn.net/base/javase&quot;&gt;Java&lt;/a&gt; Á±ªÔºåËØ•Á±ªÊòØÁõ∏ÂÖ≥ÂèòÈáèÂíå/ÊàñÊñπÊ≥ïÁöÑÈõÜÂêà„ÄÇÁ±ªÊòØÈù¢ÂêëÂØπË±°ÁöÑÁ®ãÂ∫èËÆæËÆ°ÊñπÊ≥ïÁöÑÂü∫Êú¨ÊûÑÈÄ†Âçï‰Ωç„ÄÇÁ±ªÈÄöÂ∏∏‰ª£Ë°®ÊüêÁßçÂÆûÈôÖÂÆû‰ΩìÔºåÂ¶ÇÂá†‰ΩïÂΩ¢Áä∂Êàñ‰∫∫„ÄÇÁ±ªÊòØÂØπË±°ÁöÑÊ®°Êùø„ÄÇÊØè‰∏™ÂØπË±°ÈÉΩÊòØÁ±ªÁöÑ‰∏Ä‰∏™ÂÆû‰æã„ÄÇË¶Å‰ΩøÁî®Á±ªÔºåÈÄöÂ∏∏‰ΩøÁî® new Êìç‰ΩúÁ¨¶Â∞ÜÁ±ªÁöÑÂØπË±°ÂÆû‰æãÂåñÔºåÁÑ∂ÂêéË∞ÉÁî®Á±ªÁöÑÊñπÊ≥ïÊù•ËÆøÈóÆÁ±ªÁöÑÂäüËÉΩ„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;3-extends-ÁªßÊâøÊâ©Â±ï&quot;&gt;3) extends ÁªßÊâø„ÄÅÊâ©Â±ï&lt;/h4&gt;

&lt;p&gt;extends ÂÖ≥ÈîÆÂ≠óÁî®Âú® class Êàñ interface Â£∞Êòé‰∏≠ÔºåÁî®‰∫éÊåáÁ§∫ÊâÄÂ£∞ÊòéÁöÑÁ±ªÊàñÊé•Âè£ÊòØÂÖ∂ÂêçÁß∞ÂêéË∑üÊúâ extends ÂÖ≥ÈîÆÂ≠óÁöÑÁ±ªÊàñÊé•Âè£ÁöÑÂ≠êÁ±ª„ÄÇÂ≠êÁ±ªÁªßÊâøÁà∂Á±ªÁöÑÊâÄÊúâ public Âíå protected ÂèòÈáèÂíåÊñπÊ≥ï„ÄÇ Â≠êÁ±ªÂèØ‰ª•ÈáçÂÜôÁà∂Á±ªÁöÑ‰ªª‰ΩïÈùû final ÊñπÊ≥ï„ÄÇ‰∏Ä‰∏™Á±ªÂè™ËÉΩÊâ©Â±ï‰∏Ä‰∏™ÂÖ∂‰ªñÁ±ª„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;4-final-ÊúÄÁªà‰∏çÂèØÊîπÂèò&quot;&gt;4) final ÊúÄÁªà„ÄÅ‰∏çÂèØÊîπÂèò&lt;/h4&gt;

&lt;p&gt;final ÂÖ≥ÈîÆÂ≠óÂèØ‰ª•Â∫îÁî®‰∫éÁ±ªÔºå‰ª•ÊåáÁ§∫‰∏çËÉΩÊâ©Â±ïËØ•Á±ªÔºà‰∏çËÉΩÊúâÂ≠êÁ±ªÔºâ„ÄÇfinal ÂÖ≥ÈîÆÂ≠óÂèØ‰ª•Â∫îÁî®‰∫éÊñπÊ≥ïÔºå‰ª•ÊåáÁ§∫Âú®Â≠êÁ±ª‰∏≠‰∏çËÉΩÈáçÂÜôÊ≠§ÊñπÊ≥ï„ÄÇ‰∏Ä‰∏™Á±ª‰∏çËÉΩÂêåÊó∂ÊòØ abstract ÂèàÊòØ final„ÄÇabstract ÊÑèÂë≥ÁùÄÂøÖÈ°ªÊâ©Â±ïÁ±ªÔºåfinal ÊÑèÂë≥ÁùÄ‰∏çËÉΩÊâ©Â±ïÁ±ª„ÄÇ‰∏Ä‰∏™ÊñπÊ≥ï‰∏çËÉΩÂêåÊó∂ÊòØ abstract ÂèàÊòØ final„ÄÇabstract ÊÑèÂë≥ÁùÄÂøÖÈ°ªÈáçÂÜôÊñπÊ≥ïÔºåfinal ÊÑèÂë≥ÁùÄ‰∏çËÉΩÈáçÂÜôÊñπÊ≥ï„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;5-implementsÂÆûÁé∞&quot;&gt;5) implementsÂÆûÁé∞&lt;/h4&gt;

&lt;p&gt;implements ÂÖ≥ÈîÆÂ≠óÂú® class Â£∞Êòé‰∏≠‰ΩøÁî®Ôºå‰ª•ÊåáÁ§∫ÊâÄÂ£∞ÊòéÁöÑÁ±ªÊèê‰æõ‰∫ÜÂú® implements ÂÖ≥ÈîÆÂ≠óÂêéÈù¢ÁöÑÂêçÁß∞ÊâÄÊåáÂÆöÁöÑÊé•Âè£‰∏≠ÊâÄÂ£∞ÊòéÁöÑÊâÄÊúâÊñπÊ≥ïÁöÑÂÆûÁé∞„ÄÇÁ±ªÂøÖÈ°ªÊèê‰æõÂú®Êé•Âè£‰∏≠ÊâÄÂ£∞ÊòéÁöÑÊâÄÊúâÊñπÊ≥ïÁöÑÂÆûÁé∞„ÄÇ‰∏Ä‰∏™Á±ªÂèØ‰ª•ÂÆûÁé∞Â§ö‰∏™Êé•Âè£„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;6-interface-Êé•Âè£&quot;&gt;6) interface Êé•Âè£&lt;/h4&gt;

&lt;p&gt;interface ÂÖ≥ÈîÆÂ≠óÁî®Êù•Â£∞ÊòéÊñ∞ÁöÑ Java Êé•Âè£ÔºåÊé•Âè£ÊòØÊñπÊ≥ïÁöÑÈõÜÂêà„ÄÇ&lt;/p&gt;

&lt;p&gt;Êé•Âè£ÊòØ Java ËØ≠Ë®ÄÁöÑ‰∏ÄÈ°πÂº∫Â§ßÂäüËÉΩ„ÄÇ‰ªª‰ΩïÁ±ªÈÉΩÂèØÂ£∞ÊòéÂÆÉÂÆûÁé∞‰∏Ä‰∏™ÊàñÂ§ö‰∏™Êé•Âè£ÔºåËøôÊÑèÂë≥ÁùÄÂÆÉÂÆûÁé∞‰∫ÜÂú®Ëøô‰∫õÊé•Âè£‰∏≠ÊâÄÂÆö‰πâÁöÑÊâÄÊúâÊñπÊ≥ï„ÄÇ&lt;/p&gt;

&lt;p&gt;ÂÆûÁé∞‰∫ÜÊé•Âè£ÁöÑ‰ªª‰ΩïÁ±ªÈÉΩÂøÖÈ°ªÊèê‰æõÂú®ËØ•Êé•Âè£‰∏≠ÁöÑÊâÄÊúâÊñπÊ≥ïÁöÑÂÆûÁé∞„ÄÇ‰∏Ä‰∏™Á±ªÂèØ‰ª•ÂÆûÁé∞Â§ö‰∏™Êé•Âè£„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;7-native-Êú¨Âú∞&quot;&gt;7) native Êú¨Âú∞&lt;/h4&gt;

&lt;p&gt;native ÂÖ≥ÈîÆÂ≠óÂèØ‰ª•Â∫îÁî®‰∫éÊñπÊ≥ïÔºå‰ª•ÊåáÁ§∫ËØ•ÊñπÊ≥ïÊòØÁî® Java ‰ª•Â§ñÁöÑËØ≠Ë®ÄÂÆûÁé∞ÁöÑ„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;8-new-Êñ∞ÂàõÂª∫&quot;&gt;8) new Êñ∞,ÂàõÂª∫&lt;/h4&gt;

&lt;p&gt;new ÂÖ≥ÈîÆÂ≠óÁî®‰∫éÂàõÂª∫Á±ªÁöÑÊñ∞ÂÆû‰æã„ÄÇ&lt;/p&gt;

&lt;p&gt;new ÂÖ≥ÈîÆÂ≠óÂêéÈù¢ÁöÑÂèÇÊï∞ÂøÖÈ°ªÊòØÁ±ªÂêçÔºåÂπ∂‰∏îÁ±ªÂêçÁöÑÂêéÈù¢ÂøÖÈ°ªÊòØ‰∏ÄÁªÑÊûÑÈÄ†ÊñπÊ≥ïÂèÇÊï∞ÔºàÂøÖÈ°ªÂ∏¶Êã¨Âè∑Ôºâ„ÄÇ&lt;/p&gt;

&lt;p&gt;ÂèÇÊï∞ÈõÜÂêàÂøÖÈ°ª‰∏éÁ±ªÁöÑÊûÑÈÄ†ÊñπÊ≥ïÁöÑÁ≠æÂêçÂåπÈÖç„ÄÇ&lt;/p&gt;

&lt;p&gt;= Â∑¶‰æßÁöÑÂèòÈáèÁöÑÁ±ªÂûãÂøÖÈ°ª‰∏éË¶ÅÂÆû‰æãÂåñÁöÑÁ±ªÊàñÊé•Âè£ÂÖ∑ÊúâËµãÂÄºÂÖºÂÆπÂÖ≥Á≥ª„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;9-static-ÈùôÊÄÅ&quot;&gt;9) static ÈùôÊÄÅ&lt;/h4&gt;

&lt;p&gt;static ÂÖ≥ÈîÆÂ≠óÂèØ‰ª•Â∫îÁî®‰∫éÂÜÖÈÉ®Á±ªÔºàÂú®Âè¶‰∏Ä‰∏™Á±ª‰∏≠ÂÆö‰πâÁöÑÁ±ªÔºâ„ÄÅÊñπÊ≥ïÊàñÂ≠óÊÆµÔºàÁ±ªÁöÑÊàêÂëòÂèòÈáèÔºâ„ÄÇ&lt;/p&gt;

&lt;p&gt;ÈÄöÂ∏∏Ôºåstatic ÂÖ≥ÈîÆÂ≠óÊÑèÂë≥ÁùÄÂ∫îÁî®ÂÆÉÁöÑÂÆû‰ΩìÂú®Â£∞ÊòéËØ•ÂÆû‰ΩìÁöÑÁ±ªÁöÑ‰ªª‰ΩïÁâπÂÆöÂÆû‰æãÂ§ñÈÉ®ÂèØÁî®„ÄÇ&lt;/p&gt;

&lt;p&gt;staticÔºàÂÜÖÈÉ®ÔºâÁ±ªÂèØ‰ª•Ë¢´ÂÖ∂‰ªñÁ±ªÂÆû‰æãÂåñÂíåÂºïÁî®ÔºàÂç≥‰ΩøÂÆÉÊòØÈ°∂Á∫ßÁ±ªÔºâ„ÄÇÂú®‰∏äÈù¢ÁöÑÁ§∫‰æã‰∏≠ÔºåÂè¶‰∏Ä‰∏™Á±ª‰∏≠ÁöÑ‰ª£Á†ÅÂèØ‰ª•ÂÆû‰æãÂåñ MyStaticClass Á±ªÔºåÊñπÊ≥ïÊòØÁî®ÂåÖÂê´ÂÆÉÁöÑÁ±ªÂêçÊù•ÈôêÂÆöÂÖ∂ÂêçÁß∞ÔºåÂ¶Ç MyClass.MyStaticClass„ÄÇ&lt;/p&gt;

&lt;p&gt;static Â≠óÊÆµÔºàÁ±ªÁöÑÊàêÂëòÂèòÈáèÔºâÂú®Á±ªÁöÑÊâÄÊúâÂÆû‰æã‰∏≠Âè™Â≠òÂú®‰∏ÄÊ¨°„ÄÇ&lt;/p&gt;

&lt;p&gt;ÂèØ‰ª•‰ªéÁ±ªÁöÑÂ§ñÈÉ®Ë∞ÉÁî® static ÊñπÊ≥ïÔºåËÄå‰∏çÁî®È¶ñÂÖàÂÆû‰æãÂåñËØ•Á±ª„ÄÇËøôÊ†∑ÁöÑÂºïÁî®ÂßãÁªàÂåÖÊã¨Á±ªÂêç‰Ωú‰∏∫ÊñπÊ≥ïË∞ÉÁî®ÁöÑÈôêÂÆöÁ¨¶„ÄÇ&lt;/p&gt;

&lt;p&gt;Ê®°ÂºèÔºöpublic final static &lt;type&gt; varName = &lt;value&gt;; ÈÄöÂ∏∏Áî®‰∫éÂ£∞ÊòéÂèØ‰ª•Âú®Á±ªÁöÑÂ§ñÈÉ®‰ΩøÁî®ÁöÑÁ±ªÂ∏∏Èáè„ÄÇÂú®ÂºïÁî®ËøôÊ†∑ÁöÑÁ±ªÂ∏∏ÈáèÊó∂ÈúÄË¶ÅÁî®Á±ªÂêçÂä†‰ª•ÈôêÂÆö„ÄÇÂú®‰∏äÈù¢ÁöÑÁ§∫‰æã‰∏≠ÔºåÂè¶‰∏Ä‰∏™Á±ªÂèØ‰ª•Áî® MyClass.MAX_OBJECTS ÂΩ¢ÂºèÊù•ÂºïÁî® MAX_OBJECTS Â∏∏Èáè„ÄÇ&lt;/value&gt;&lt;/type&gt;&lt;/p&gt;

&lt;h4 id=&quot;10-strictfp-‰∏•Ê†ºÁ≤æÂáÜ&quot;&gt;10) strictfp ‰∏•Ê†º,Á≤æÂáÜ&lt;/h4&gt;

&lt;p&gt;strictfpÁöÑÊÑèÊÄùÊòØFP-strictÔºå‰πüÂ∞±ÊòØËØ¥Á≤æÁ°ÆÊµÆÁÇπÁöÑÊÑèÊÄù„ÄÇÂú®JavaËôöÊãüÊú∫ËøõË°åÊµÆÁÇπËøêÁÆóÊó∂ÔºåÂ¶ÇÊûúÊ≤°ÊúâÊåáÂÆöstrictfpÂÖ≥ÈîÆÂ≠óÊó∂ÔºåJavaÁöÑÁºñËØëÂô®‰ª•ÂèäËøêË°åÁéØÂ¢ÉÂú®ÂØπÊµÆÁÇπËøêÁÆóÁöÑË°®ËææÂºèÊòØÈááÂèñ‰∏ÄÁßçËøë‰ºº‰∫éÊàëË°åÊàëÁ¥†ÁöÑË°å‰∏∫Êù•ÂÆåÊàêËøô‰∫õÊìç‰ΩúÔºå‰ª•Ëá¥‰∫éÂæóÂà∞ÁöÑÁªìÊûúÂæÄÂæÄÊó†Ê≥ï‰ª§‰∫∫Êª°ÊÑè„ÄÇËÄå‰∏ÄÊó¶‰ΩøÁî®‰∫ÜstrictfpÊù•Â£∞Êòé‰∏Ä‰∏™Á±ª„ÄÅÊé•Âè£ÊàñËÄÖÊñπÊ≥ïÊó∂ÔºåÈÇ£‰πàÊâÄÂ£∞ÊòéÁöÑËåÉÂõ¥ÂÜÖJavaÁöÑÁºñËØëÂô®‰ª•ÂèäËøêË°åÁéØÂ¢É‰ºöÂÆåÂÖ®‰æùÁÖßÊµÆÁÇπËßÑËåÉIEEE-754Êù•ÊâßË°å„ÄÇÂõ†Ê≠§Â¶ÇÊûúÊÉ≥ËÆ©ÊµÆÁÇπËøêÁÆóÊõ¥Âä†Á≤æÁ°ÆÔºåËÄå‰∏î‰∏ç‰ºöÂõ†‰∏∫‰∏çÂêåÁöÑÁ°¨‰ª∂Âπ≥Âè∞ÊâÄÊâßË°åÁöÑÁªìÊûú‰∏ç‰∏ÄËá¥ÁöÑËØùÔºåÈÇ£Â∞±ËØ∑Áî®ÂÖ≥ÈîÆÂ≠óstrictfp„ÄÇ&lt;/p&gt;

&lt;p&gt;ÂèØ‰ª•Â∞Ü‰∏Ä‰∏™Á±ª„ÄÅÊé•Âè£‰ª•ÂèäÊñπÊ≥ïÂ£∞Êòé‰∏∫strictfpÔºå‰ΩÜÊòØ‰∏çÂÖÅËÆ∏ÂØπÊé•Âè£‰∏≠ÁöÑÊñπÊ≥ï‰ª•ÂèäÊûÑÈÄ†ÂáΩÊï∞Â£∞ÊòéstrictfpÂÖ≥ÈîÆÂ≠ó&lt;/p&gt;

&lt;h4 id=&quot;11-synchronizedÁ∫øÁ®ãÂêåÊ≠•&quot;&gt;11) synchronizedÁ∫øÁ®ã„ÄÅÂêåÊ≠•&lt;/h4&gt;

&lt;p&gt;synchronized ÂÖ≥ÈîÆÂ≠óÂèØ‰ª•Â∫îÁî®‰∫éÊñπÊ≥ïÊàñËØ≠Âè•ÂùóÔºåÂπ∂‰∏∫‰∏ÄÊ¨°Âè™Â∫îÁî±‰∏Ä‰∏™Á∫øÁ®ãÊâßË°åÁöÑÂÖ≥ÈîÆ‰ª£Á†ÅÊÆµÊèê‰æõ‰øùÊä§„ÄÇ&lt;/p&gt;

&lt;p&gt;synchronized ÂÖ≥ÈîÆÂ≠óÂèØÈò≤Ê≠¢‰ª£Á†ÅÁöÑÂÖ≥ÈîÆ‰ª£Á†ÅÊÆµ‰∏ÄÊ¨°Ë¢´Â§ö‰∏™Á∫øÁ®ãÊâßË°å„ÄÇ&lt;/p&gt;

&lt;p&gt;Â¶ÇÊûúÂ∫îÁî®‰∫éÈùôÊÄÅÊñπÊ≥ïÔºåÈÇ£‰πàÔºåÂΩìËØ•ÊñπÊ≥ï‰∏ÄÊ¨°Áî±‰∏Ä‰∏™Á∫øÁ®ãÊâßË°åÊó∂ÔºåÊï¥‰∏™Á±ªÂ∞ÜË¢´ÈîÅÂÆö„ÄÇ&lt;/p&gt;

&lt;p&gt;Â¶ÇÊûúÂ∫îÁî®‰∫éÂÆû‰æãÊñπÊ≥ïÔºåÈÇ£‰πàÔºåÂΩìËØ•ÊñπÊ≥ï‰∏ÄÊ¨°Áî±‰∏Ä‰∏™Á∫øÁ®ãËÆøÈóÆÊó∂ÔºåËØ•ÂÆû‰æãÂ∞ÜË¢´ÈîÅÂÆö„ÄÇ&lt;/p&gt;

&lt;p&gt;Â¶ÇÊûúÂ∫îÁî®‰∫éÂØπË±°ÊàñÊï∞ÁªÑÔºåÂΩìÂÖ≥ËÅîÁöÑ‰ª£Á†ÅÂùó‰∏ÄÊ¨°Áî±‰∏Ä‰∏™Á∫øÁ®ãÊâßË°åÊó∂ÔºåÂØπË±°ÊàñÊï∞ÁªÑÂ∞ÜË¢´ÈîÅÂÆö„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;12-transient-Áü≠ÊöÇ&quot;&gt;12) transient Áü≠ÊöÇ&lt;/h4&gt;

&lt;p&gt;transient ÂÖ≥ÈîÆÂ≠óÂèØ‰ª•Â∫îÁî®‰∫éÁ±ªÁöÑÊàêÂëòÂèòÈáèÔºå‰ª•‰æøÊåáÂá∫ËØ•ÊàêÂëòÂèòÈáè‰∏çÂ∫îÂú®ÂåÖÂê´ÂÆÉÁöÑÁ±ªÂÆû‰æãÂ∑≤Â∫èÂàóÂåñÊó∂Ë¢´Â∫èÂàóÂåñ„ÄÇ&lt;/p&gt;

&lt;p&gt;ÂΩì‰∏Ä‰∏™ÂØπË±°Ë¢´‰∏≤Ë°åÂåñÁöÑÊó∂ÂÄôÔºåtransientÂûãÂèòÈáèÁöÑÂÄº‰∏çÂåÖÊã¨Âú®‰∏≤Ë°åÂåñÁöÑË°®Á§∫‰∏≠ÔºåÁÑ∂ËÄåÈùûtransientÂûãÁöÑÂèòÈáèÊòØË¢´ÂåÖÊã¨ËøõÂéªÁöÑ„ÄÇ&lt;/p&gt;

&lt;p&gt;JavaÁöÑserializationÊèê‰æõ‰∫Ü‰∏ÄÁßçÊåÅ‰πÖÂåñÂØπË±°ÂÆû‰æãÁöÑÊú∫Âà∂„ÄÇÂΩìÊåÅ‰πÖÂåñÂØπË±°Êó∂ÔºåÂèØËÉΩÊúâ‰∏Ä‰∏™ÁâπÊÆäÁöÑÂØπË±°Êï∞ÊçÆÊàêÂëòÔºåÊàë‰ª¨‰∏çÊÉ≥Áî®serializationÊú∫Âà∂Êù•‰øùÂ≠òÂÆÉ„ÄÇ‰∏∫‰∫ÜÂú®‰∏Ä‰∏™ÁâπÂÆöÂØπË±°ÁöÑ‰∏Ä‰∏™Âüü‰∏äÂÖ≥Èó≠serializationÔºåÂèØ‰ª•Âú®Ëøô‰∏™ÂüüÂâçÂä†‰∏äÂÖ≥ÈîÆÂ≠ótransient„ÄÇ
     transientÊòØJavaËØ≠Ë®ÄÁöÑÂÖ≥ÈîÆÂ≠óÔºåÁî®Êù•Ë°®Á§∫‰∏Ä‰∏™Âüü‰∏çÊòØËØ•ÂØπË±°‰∏≤Ë°åÂåñÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇÂΩì‰∏Ä‰∏™ÂØπË±°Ë¢´‰∏≤Ë°åÂåñÁöÑÊó∂ÂÄôÔºåtransientÂûãÂèòÈáèÁöÑÂÄº‰∏çÂåÖÊã¨Âú®‰∏≤Ë°åÂåñÁöÑË°®Á§∫‰∏≠ÔºåÁÑ∂ËÄåÈùûtransientÂûãÁöÑÂèòÈáèÊòØË¢´ÂåÖÊã¨ËøõÂéªÁöÑ„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;13-volatile-ÊòìÂ§±&quot;&gt;13) volatile ÊòìÂ§±&lt;/h4&gt;

&lt;p&gt;volatile ÂÖ≥ÈîÆÂ≠óÁî®‰∫éË°®Á§∫ÂèØ‰ª•Ë¢´Â§ö‰∏™Á∫øÁ®ãÂºÇÊ≠•‰øÆÊîπÁöÑÊàêÂëòÂèòÈáè„ÄÇ&lt;/p&gt;

&lt;p&gt;Ê≥®ÊÑèÔºövolatile ÂÖ≥ÈîÆÂ≠óÂú®ËÆ∏Â§ö Java ËôöÊãüÊú∫‰∏≠ÈÉΩÊ≤°ÊúâÂÆûÁé∞„ÄÇ volatile ÁöÑÁõÆÊ†áÁî®ÈÄîÊòØ‰∏∫‰∫ÜÁ°Æ‰øùÊâÄÊúâÁ∫øÁ®ãÊâÄÁúãÂà∞ÁöÑÊåáÂÆöÂèòÈáèÁöÑÂÄºÈÉΩÊòØÁõ∏ÂêåÁöÑ„ÄÇ&lt;/p&gt;

&lt;p&gt;Java ËØ≠Ë®Ä‰∏≠ÁöÑ volatile ÂèòÈáèÂèØ‰ª•Ë¢´Áúã‰ΩúÊòØ‰∏ÄÁßç ‚ÄúÁ®ãÂ∫¶ËæÉËΩªÁöÑ synchronized‚ÄùÔºõ‰∏é synchronized ÂùóÁõ∏ÊØîÔºåvolatile ÂèòÈáèÊâÄÈúÄÁöÑÁºñÁ†ÅËæÉÂ∞ëÔºåÂπ∂‰∏îËøêË°åÊó∂ÂºÄÈîÄ‰πüËæÉÂ∞ëÔºå‰ΩÜÊòØÂÆÉÊâÄËÉΩÂÆûÁé∞ÁöÑÂäüËÉΩ‰πü‰ªÖÊòØ synchronized ÁöÑ‰∏ÄÈÉ®ÂàÜ„ÄÇ&lt;/p&gt;
</description>
        <pubDate>Mon, 09 Jul 2018 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2018/07/09/java%E7%9F%A5%E8%AF%86%E6%90%AC%E8%BF%90/</link>
        <guid isPermaLink="true">http://localhost:4000/2018/07/09/java%E7%9F%A5%E8%AF%86%E6%90%AC%E8%BF%90/</guid>
        
        
      </item>
    
      <item>
        <title>YarnÂ≠¶‰π†Á¨îËÆ∞</title>
        <description>&lt;h2 id=&quot;yarnÂ≠¶‰π†Á¨îËÆ∞&quot;&gt;YARNÂ≠¶‰π†Á¨îËÆ∞&lt;/h2&gt;

&lt;h3 id=&quot;introduction&quot;&gt;Introduction&lt;/h3&gt;

&lt;p&gt;Êú¨Ê¨°Â≠¶‰π†Á¨îËÆ∞ÂÄüÈâ¥Hadoop YARNÊùÉÂ®ÅÊåáÂçó‰π¶Á±çÔºåËøõË°åËæÉ‰∏∫ÊúâÁõÆÁöÑÁöÑÈòÖËØªÔºåÊúÄÂêéÂ∞ÜËá™Â∑±ÊâÄÊÉ≥‰∫ÜËß£ÁöÑÂÜÖÂÆπËÆ∞ÂΩï‰∫éÁ¨îËÆ∞‰∏≠‰ª•‰æõÂêéÁª≠ÁöÑÂ≠¶‰π†„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;yarnÂéÜÂè≤&quot;&gt;YARNÂéÜÂè≤&lt;/h4&gt;

&lt;h5 id=&quot;ad-hocÈõÜÁæ§&quot;&gt;Ad HocÈõÜÁæ§&lt;/h5&gt;

&lt;p&gt;Á±ª‰ºº‰∫éÂ§öÂè∞‰∏ªÊú∫‰∏äËøêË°åÁöÑÊ°åÈù¢Â∫îÁî®ÔºåÊÑüËßâ‰∏äÂèØËÉΩÊòØÂ§öÂè∞Êú∫Âô®‰∏äÊâãÂä®ËøõË°åÂ∫îÁî®ËøêË°åÔºå‰ΩÜÊòØÊú∫Âô®‰πãÈó¥ÁöÑÊñá‰ª∂‰∏çÂÖ±‰∫´„ÄÇ&lt;/p&gt;

&lt;h5 id=&quot;hod&quot;&gt;HOD&lt;/h5&gt;

&lt;ul&gt;
  &lt;li&gt;Âä†ÂÖ•Ë∞ÉÂ∫¶Âô®ResourceManager&lt;/li&gt;
  &lt;li&gt;ÂíåRM‰∫§‰∫íÁöÑÂ§ö‰∏™ÁªÑ‰ª∂&lt;/li&gt;
  &lt;li&gt;MR‰ª•ÂèäHDFSÂÆàÊä§ËøõÁ®ã&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;‰ºòÁÇπÔºöÂèØÂ§öÁî®Êà∑Â§öÈõÜÁæ§ÁöÑËøêË°åÔºåÂà©Áî®ÁéáÊõ¥È´òÔºåËÆæËÆ°Êõ¥ÂêàÁêÜ&lt;/p&gt;

&lt;p&gt;Áº∫ÁÇπÔºö‰∏çÁü•ÈÅìHDFSÁöÑÊñá‰ª∂ÂàÜÂ∏ÉÔºåÂàÜÈÖçËäÇÁÇπÊó∂‰∏çËÉΩËÄÉËôëHDFSÁöÑÊñá‰ª∂ÂíåÂ∫îÁî®Âú®‰∏Ä‰∏™ËäÇÁÇπ‰∏äÂêóÔºå‰ªéËÄåÂ¢ûÂ§ßÁΩëÁªúÂºÄÈîÄ„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://ox0pxbncm.bkt.clouddn.com/18-6-21/39119611.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h5 id=&quot;ÂÖ±‰∫´ÈõÜÁæ§&quot;&gt;ÂÖ±‰∫´ÈõÜÁæ§&lt;/h5&gt;

&lt;p&gt;‰∏ªË¶ÅÁªÑ‰ª∂Ôºö&lt;/p&gt;

&lt;p&gt;JobTrackerÔºåÂèØ‰ª•ÁÆ°ÁêÜÊï¥‰∏™ÈõÜÁæ§ÁöÑjobÔºåÊúâÁÇπÁ±ª‰ººYARN‰∏≠ÁöÑAppMasterÔºå‰ΩÜÊòØAppMasterÂè™ÁÆ°ÁêÜ‰∏Ä‰∏™job„ÄÇ&lt;/p&gt;

&lt;p&gt;TaskTrackerÔºåÊé•ÂèóJobtrackerÁöÑÂëΩ‰ª§ÁÑ∂ÂêéÊâßË°åÔºåÂèØ‰ª•ËøêË°åÊâÄÊúâÁöÑ‰Ωú‰∏ö„ÄÇ&lt;/p&gt;

&lt;h5 id=&quot;yarn&quot;&gt;YARN&lt;/h5&gt;

&lt;p&gt;Ë¶ÅÊ±ÇÔºöÂèØÊãìÂ±ïÊÄßÔºåÂèØÁª¥ÊåÅË°åÔºåÂ§öÁî®Êà∑Ôºå‰ΩçÁΩÆÊÑüÁü•ÔºåÈõÜÁæ§È´ò‰ΩøÁî®ÁéáÔºåÂÆâÂÖ®ÔºåÁºñÁ®ãÊ®°ÂûãÂ§öÊ†∑ÊÄßÔºåÂêëÂêéÂÖºÂÆπ„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://ox0pxbncm.bkt.clouddn.com/18-6-21/152392.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;yarnËÆæËÆ°ÁªÜËäÇ&quot;&gt;YARNËÆæËÆ°ÁªÜËäÇ&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;YARNÁõÆÂâçÁöÑËÆæËÆ°ÊòØ‰∏∫‰∫ÜÊõ¥ÁªÜÁ≤íÂ∫¶ÁöÑÊéßÂà∂‰ªªÂä°ÔºåËÆæËÆ°‰∏Ä‰∏™ApplicationMasterÊéßÂà∂ÊØè‰∏™jobÔºåÈöîÁ¶ªÊØè‰∏™Â∫îÁî®ÁöÑËµÑÊ∫êÂàÜÈÖç„ÄÇ&lt;/li&gt;
  &lt;li&gt;containerÊòØ‰∏ÄÁßçËµÑÊ∫êÂàÜÈÖçÊñπÂºèÔºåÁßüÁ∫¶„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;YARNÁªÑ‰ª∂Ôºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;ResourceManagerÔºö‰∏ªËäÇÁÇπÔºåË¥üË¥£Ë∞ÉÂ∫¶Ôºå‰πüÂèØ‰ª•ÊÅ¢Â§çApplicationMasterÁöÑÁä∂ÊÄÅ„ÄÇ&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;YARNË∞ÉÂ∫¶ÁªÑ‰ª∂Ôºö‰∏Ä‰∏™ÂèØÊèíÊãîÁöÑË∞ÉÂ∫¶Âô®ÔºåFIFOÔºåcapasityÔºåFair Share„ÄÇ‰∏ªË¶ÅÈíàÂØπÂ§ö‰∏™‰ªªÂä°ÈòüÂàóÁöÑË∞ÉÂ∫¶ÔºåÂú®Â§öÁî®Êà∑ÁöÑ‰ªªÂä°Ë∞ÉÂ∫¶‰∏≠ÂæàÊúâÁî®„ÄÇ&lt;/li&gt;
  &lt;li&gt;containerÔºöÊòØÊâÄÊúâÁ°¨‰ª∂ËµÑÊ∫êÁöÑÈõÜÂêà„ÄÇ&lt;/li&gt;
  &lt;li&gt;NodeManagerÔºöËøêË°åJobÁöÑtaskÂÆû‰æã„ÄÇ&lt;/li&gt;
  &lt;li&gt;ApplicationMasterÔºöÂçèË∞ÉappÁöÑËøõÁ®ã„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;YARNÊû∂ÊûÑ&lt;/strong&gt;Ôºö&lt;/p&gt;

&lt;p&gt;Á¨¨‰∏Ä‰ª£ÁöÑHadoopÊòØÂ∫îÁî®Âπ≥Âè∞‰∏çÂàÜÁ¶ªÁöÑÔºåÁ¨¨‰∫å‰ª£ÂàÜÁ¶ªÂá∫‰∫ÜÂ∫îÁî®Ôºå‰ΩøÁî®ApplicationMasterÁÆ°ÁêÜÂ∫îÁî®„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://ox0pxbncm.bkt.clouddn.com/18-6-21/38612004.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ResourceManagerÂäüËÉΩ&lt;/strong&gt;Ôºö&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://ox0pxbncm.bkt.clouddn.com/18-6-21/17294017.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;ÂÆ¢Êà∑Á´Ø‰∏éRM‰∫§‰∫íÔºöÂ∫îÁî®Á®ãÂ∫èÊèê‰∫§ÔºåÂ∫îÁî®Á®ãÂ∫èÁªàÊ≠¢ÔºåËé∑ÂèñÂ∫îÁî®Á®ãÂ∫èÔºåÈòüÂàóÔºåÈõÜÁæ§ÁªüËÆ°„ÄÇ&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Â∫îÁî®Á®ãÂ∫è‰∏éRMÈÄö‰ø°ÔºöÊ≥®ÂÜåÊñ∞ËäÇÁÇπÔºåÊé•ÂèóNMÁöÑÂøÉË∑≥„ÄÇ&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Ê†∏ÂøÉÁªÑ‰ª∂Ôºö&lt;/p&gt;

    &lt;p&gt;ApplicationManagerÔºöË¥üË¥£ÁÆ°ÁêÜÂ∑≤Êèê‰∫§Â∫îÁî®Á®ãÂ∫èÁöÑÈõÜÂêà„ÄÇ&lt;/p&gt;

    &lt;p&gt;ApplicationMaster LauncherÔºöÂêØÂä®ÂêÑÂ∫îÁî®ÁöÑApplicationMaster„ÄÇ&lt;/p&gt;

    &lt;p&gt;YarnSchedulerÔºöË¥üË¥£ÁªôÊ≠£Âú®ËøêË°åÁöÑËøêÁî®Á®ãÂ∫èÂàÜÈÖçËµÑÊ∫ê„ÄÇ&lt;/p&gt;

    &lt;p&gt;ContainerAllocationExpirerÔºöÂ∞ÜÂØπÂ∑≤ÂàÜÈÖç‰ΩÜÊòØÊú™‰ΩøÁî®ÁöÑcontainerËøõË°åËøáÊúüÂõûÊî∂„ÄÇ&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;NodeManager&lt;/strong&gt;Ôºö&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Ë¥üË¥£containerÁÆ°ÁêÜ„ÄÇ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;http://ox0pxbncm.bkt.clouddn.com/18-6-21/73622478.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Container Launch Context(CLC)ÔºöÊèèËø∞container„ÄÇ&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;‰∏ªË¶ÅÂäüËÉΩÔºö&lt;/p&gt;

    &lt;p&gt;&lt;strong&gt;containerÂêØÂä®Ôºö&lt;/strong&gt;ÂàõÂª∫ËµÑÊ∫êÁöÑÂâØÊú¨„ÄÇÂàõÂª∫Áã¨Á´ãÁöÑÂ∑•‰ΩúÁõÆÂΩï„ÄÇÂêØÂä®containerÁöÑÁéØÂ¢ÉÂíåÂëΩ‰ª§Ë°å„ÄÇ&lt;/p&gt;

    &lt;p&gt;Áî®Êà∑Êó•ÂøóÁÆ°ÁêÜÂèäËÅöÈõÜ„ÄÇ&lt;/p&gt;

    &lt;p&gt;MapReduce ShuffleËæÖÂä©ÊúçÂä°„ÄÇ&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Ê†∏ÂøÉÁªÑ‰ª∂Ôºö&lt;/p&gt;

    &lt;p&gt;NodeStatusUpdaterÔºöÂÆöÊúüÂêëRMÂèëÈÄÅËäÇÁÇπÂèØÁî®ËµÑÊ∫ê„ÄÇ&lt;/p&gt;

    &lt;p&gt;ContainerManagerÔºöÊ†∏ÂøÉÁªÑ‰ª∂ÔºåÁÆ°ÁêÜcontainerÔºåÂåÖÂê´RPC serverÂíåËµÑÊ∫êÊú¨Âú∞ÂåñÊúçÂä°„ÄÇ&lt;/p&gt;

    &lt;p&gt;RPC ServerÔºöContainerManagerÊé•ÂèóAMÂêØÂä®Êñ∞ÁöÑcontainerÊàñÂÅúÊ≠¢containerËØ∑Ê±Ç„ÄÇ&lt;/p&gt;

    &lt;p&gt;ËµÑÊ∫êÊú¨Âú∞ÂåñÊúçÂä°ÔºöË¥üË¥£ÂÆâÂÖ®ÁöÑ‰∏ãËΩΩÂíåÁªÑÁªácontainerÊâÄÈúÄÁöÑÂêÑÁßçÊñá‰ª∂ËµÑÊ∫ê„ÄÇÂ∞ΩÂèØËÉΩÂ∞ÜÊñá‰ª∂ÂàÜÊï£Âà∞ÂêÑ‰∏™ÂèØÁî®Á£ÅÁõò„ÄÇ&lt;/p&gt;

    &lt;p&gt;Containers MonitorÔºöÁõëÊéßcontainerÁöÑËµÑÊ∫ê‰ΩøÁî®ÊÉÖÂÜµ„ÄÇ&lt;/p&gt;

    &lt;p&gt;Log HandlerÔºöÂèØÊèíÊãîÁªÑ‰ª∂Ôºå‰øùÂ≠òÊó•ÂøóÂà∞Êú¨Âú∞„ÄÇ&lt;/p&gt;

    &lt;p&gt;Container ExecutorÔºö‰∏éÂ∫ïÂ±ÇÊìç‰ΩúÁ≥ªÁªü‰∫§‰∫íÔºåÂÆâÂÖ®Èò≤ÊîæÁΩÆcontainerÊâÄÈúÄË¶ÅÁöÑÊñá‰ª∂ÂíåÁõÆÂΩï„ÄÇ&lt;/p&gt;

    &lt;p&gt;Node Health Checker ServiceÔºöÂØπËäÇÁÇπÁöÑÂÅ•Â∫∑ÊÉÖÂÜµËøõË°åÊ£ÄÊü•„ÄÇ&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;ApplicationMaster&lt;/strong&gt;Ôºö&lt;/p&gt;

&lt;p&gt;Êú¨Ë¥®‰∏äÊòØ‰∏Ä‰∏™JobTracker„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;ÁªºÂêàÁ¨îËÆ∞&quot;&gt;ÁªºÂêàÁ¨îËÆ∞&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;ÂèØ‰ª•‰ΩøÁî®ÁöÑHadoopÁÆ°ÁêÜÂ∑•ÂÖ∑ÔºöAmbari&lt;/li&gt;
  &lt;li&gt;hadoopÈõÜÁæ§ÁöÑÁªü‰∏ÄÊìç‰ΩúÂëΩ‰ª§Ôºöpdsh&lt;/li&gt;
  &lt;li&gt;ÂÆûÊó∂ÁõëÊéßÁ≥ªÁªüÔºöGanglia&lt;/li&gt;
&lt;/ul&gt;
</description>
        <pubDate>Thu, 21 Jun 2018 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2018/06/21/YARN%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</link>
        <guid isPermaLink="true">http://localhost:4000/2018/06/21/YARN%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</guid>
        
        
      </item>
    
      <item>
        <title>NgneÊÄªÁªì</title>
        <description>&lt;h2 id=&quot;ngneÊÄªÁªì&quot;&gt;NGNEÊÄªÁªì&lt;/h2&gt;

&lt;h3 id=&quot;ÂâçË®Ä&quot;&gt;ÂâçË®Ä&lt;/h3&gt;

&lt;p&gt;Âú®ËøôËæπÂéÜÊó∂123Â§©ÔºåÁªà‰∫éÊòØÂ∞ÜÊï¥‰∏™NGNEÈ°πÁõÆËµ∞ÂÆå‰∫ÜÔºåÁé∞Âú®ÊÑüËßâÊÅçÂ¶ÇÊò®Êó•ÊâçÂàöÊù•ËøôËæπ„ÄÇËøô‰πà4‰∏™Êúà‰ª•Êù•Ôºå‰πüÁÆóÊòØÈùô‰∏ãÂøÉÊù•ÔºåÁùÄÊâã‰∫éstreaming dataÂíåËØæÁ®ãÔºåËôΩÁÑ∂ËØ¥ÊÑüËßâËøòÊòØÊúâÁÇπËäÇÂ•èÊÖ¢ÔºåÊïàÁéá‰ΩéÁöÑÂ´åÁñë„ÄÇ‰∏çËøáÊÄªÁöÑÊù•ËØ¥ËøòÊòØËÆ©‰∫∫ÊØîËæÉÊª°ÊÑèÁöÑÁä∂ÊÄÅ„ÄÇÂü∫Êú¨Ê≤°ÊúâÊÄé‰πàÊîæÊùæË≠¶ÊÉïÔºåËøòÊòØÊå∫Â•ΩÁöÑÔºåÂ∫¶Ëøá‰∫ÜÊúÄËâ∞ÈöæÁöÑ‰∏ÄÊÆµÊó∂Èó¥ÔºåËøôÊÆµÊó∂Èó¥Â∞±Â•ΩÂ•ΩÁöÑÊÄªÁªì‰∏Ä‰∏ãËøôÊÆµÊó∂Èó¥ÁöÑÂæóÂ§±„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;Ê≠£Êñá&quot;&gt;Ê≠£Êñá&lt;/h3&gt;

&lt;p&gt;ËøôÊÆµÊó∂Èó¥Ôºå‰ªé‰∏ÄÊúàÂÆö‰∏ãÊù•ÂºÄÂßãÔºåÂ∞±Áü•ÈÅìÊòØ‰∏ÄÊ¨°‰∏çÂÆπÊòìÁöÑË°åÁ®ãÔºåÂΩìÁÑ∂ÊúÄÂêéÁöÑÁªìÊûúÁ°ÆÂÆûËØÅÂÆû‰∫ÜËøôÊ¨°È°πÁõÆÁöÑ‰∏çÂÆπÊòìÔºå‰∏çÊòØ‰ΩìÁé∞Âú®Â∑•‰ΩúÈáè‰∏äÈù¢ÔºåËÄåÊòØ‰ΩìÁé∞Âú®ÂøÉÁêÜÂéãÂäõÔºåÊØïÁ´üÊúâ‰∏Ä‰∏™ÈúÄË¶ÅËææÂà∞ÁöÑÁõÆÊ†áÔºåËøô‰∏™ÁõÆÊ†áÊâçÂºÄÂßãÊÑüËßâÊòØÂÆπÊòìËææÂà∞ÁöÑÔºå‰ΩÜÊòØÂú®ÁúüÂÆû‰Ωì‰ºö‰∏≠ÔºåÂèàÊòØÂè¶‰∏ÄÁï™Âú∫ÊôØÔºå‰∏äËØæÂíåsummer campÁöÑËäÇÂ•èÂÆåÂÖ®‰∏ç‰∏ÄÊ†∑ÔºåÂÜÖÂÆπ‰πüÊúâÊâÄÂèòÂåñÔºåprojectËøòÂ•ΩÔºåÂú®Â§öÊ¨°‰∫§ÊµÅ‰ª•ÂèäÂØπprojectÁÜüÊÇâ‰ª•ÂêéÔºåÂØπ‰∫éSamzaÁöÑÂºÄÂèëÊïàÊûúËøòÊòØÂæàÂ•ΩÔºåËÉΩÂ§üÊØîËæÉÁÅµÊ¥ªÁöÑËøêÁî®Samza„ÄÇËØæÁ®ãÂÖ®ÊòØËã±ËØ≠Ôºå‰∏çÂæó‰∏çËØ¥ËøôÂ≠¶ÊúüËØæÁ®ã‰∏äÁúüÁöÑÁÆóÊòØÊØîËæÉÂ§±Ë¥•ÁöÑÔºåÊ≤°Êúâ‰∏ÄËäÇËØæÊòØÂú®‰∏äËØæÁöÑÊó∂ÂÄôÊêûÊ∏ÖÊ•öÁöÑÂü∫Êú¨ÈÉΩÊòØÂú®‰∏ãËØæÂêéË¶Å‰πàËá™Â∑±ÁúãslidesË¶Å‰πàÊòØÁúãweb castÔºåËôΩÁÑ∂ÊúÄÂêéÁöÑÁªìÊûúÊòØÂü∫Êú¨ÊéåÊè°‰∫ÜËÄÅÂ∏à‰∏äËØæËÆ≤ÁöÑ‰∏úË•øÔºå‰ΩÜÊòØÊïàÁéá‰∏çÈ´òÔºåÊ≤°ÊúâÂÅöÂà∞Èôç‰ΩéÊó∂Èó¥ÁöÑËä±ÈîÄ„ÄÇ&lt;/p&gt;

&lt;p&gt;‰∏çËøáÂÖ∑‰ΩìÂ≠¶Âà∞ÁöÑ‰∏úË•øËøòÊòØÂæàÂ§öÁöÑÔºå‰∫∫ÁîüË∑Ø‰∏äÔºåËøôÊ†∑‰∏Ä‰∏™4‰∏™ÊúàÁöÑÊàêÈïøËøòÊòØÊå∫Â§ßÁöÑÔºå‰∏çËøáÁî±‰∫éÊ≤°ÊúâÊé•Ëß¶Âà∞ÂÖ∑‰ΩìÁöÑÂ§ßÈ°πÁõÆÔºåÂØπ‰∫éconcreteÁöÑ‰∏Ä‰∫õ‰∏úË•øÁúãÁöÑ‰∏çÊòØÂæàÊ∏ÖÊô∞ÔºåÂÖ∑‰ΩìÂ≠¶‰π†ÁöÑ‰∏úË•øÊúâÔºö&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;YARNÂàÜÂ∏ÉÂºè‰ªªÂä°ÂàÜÈÖçÁ≥ªÁªü&lt;/li&gt;
  &lt;li&gt;HDFSÂàÜÂ∏ÉÂºèÊñá‰ª∂Á≥ªÁªü&lt;/li&gt;
  &lt;li&gt;SamzaÂàÜÂ∏ÉÂºèÊµÅÂ§ÑÁêÜÁ≥ªÁªü&lt;/li&gt;
  &lt;li&gt;SparkÂàÜÂ∏ÉÂºèÊµÅ\ÊâπÂ§ÑÁêÜÁ≥ªÁªü&lt;/li&gt;
  &lt;li&gt;KafkaÂàÜÂ∏ÉÂºèÊ∂àÊÅØÈòüÂàó&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ÈÄöËøáËøô‰∏™È°πÁõÆÔºåÊàëÂØπ‰∏äËø∞ÁöÑÂá†‰∏™Á≥ªÁªüÁöÑÁêÜËß£ÈÉΩÂä†Ê∑±‰∫Ü‰∏ÄÂ±ÇÔºåÂä†‰∏äÂíåÂ≠¶Èïø‰∏ÄËµ∑Áúã‰∫ÜSamzaÊ∫êÁ†ÅÔºåÂØπ‰∫éSamzaÁöÑÁêÜËß£Êõ¥Ê∑±‰∫ÜÔºåÁé∞Âú®ÂØπ‰∫éSamzaÁöÑÁêÜËß£Áõ∏ÂΩì‰∫éÊòØÁ´ôÂú®‰∫Ühigh levelÁöÑËßÜËßíÁúãÈóÆÈ¢òÔºåÂæàÂ§ö‰∏úË•øÈÉΩÊõ¥Âä†ÁöÑÈÄèÂΩª„ÄÇÁõÆÂâçËÄåË®ÄËøòÊòØÊ≤°ÊúâÊõ¥Âä†ËØ¶ÁªÜËØªÂÆåÊï¥‰∏™SamzaÁöÑÊ∫êÁ†ÅÔºåÊâÄ‰ª•ÂæàÂ§ö‰∫ãÊÉÖËøòÊòØÊúâÂæÖÊèêÈ´òÁöÑÔºåÈúÄË¶ÅÂ§öÁúãÔºåËá≥Â∞ëÊääÈúÄË¶ÅÂºÑÊáÇÁöÑÈÇ£ÈÉ®ÂàÜÊ∫êÁ†ÅÁúãÂÆåÔºåÊØîÂ¶ÇËØ¥standaloneÊ®°Âºè„ÄÇËøôÈÉ®ÂàÜÊòØÈùûÂ∏∏ÂøÖË¶ÅÁöÑÔºå‰πãÂâç‰∏ÄÊÆµÊó∂Èó¥ÊòØÁùÄÊâã‰∫éËÄÉËØïÁöÑ‰∫ãÊÉÖÔºåËøôÊÆµÊó∂Èó¥Ê≤°Êúâ‰∫ãÊÉÖ‰∫ÜÔºåÈÇ£‰πàÊúâÂæàÂ§öÊó∂Èó¥ÂèØ‰ª•ËøõË°åÂü∫Á°ÄÁöÑÂ∑©Âõ∫ÔºåÂèØ‰ª•Ê∑±ÂÖ•Á†îÁ©∂ÔºåËøô‰∏™Èò∂ÊÆµÊòØÈùûÂ∏∏ÁâπÊÆäÁöÑÔºåËøòÊòØË¶ÅÂêëËÄÅÂ∏àÂ±ïÁ§∫ÊàëÁöÑÁÉ≠ÊÉÖÔºåÊàëÁöÑ‰∏ªËßÇËÉΩÂä®ÊÄß„ÄÇ&lt;/p&gt;

&lt;p&gt;ËØæÁ®ã‰∏äÔºåÂ≠¶‰π†‰∫ÜËÆ°ÁÆóÊú∫ÂÆâÂÖ®ÂíåÊú∫Âô®Â≠¶‰π†ÔºåËøô‰∏§Èó®ËØæÂÜÖÂÆπÈÉΩÊå∫Â•ΩÁöÑÔºå‰ΩÜÊòØÈöæÂèóÁöÑÊòØÂØπÊàëÊù•ËØ¥ÂæàÂ§öÈÉΩÂê¨‰∏çÊáÇÔºå‰∏ÄÊñπÈù¢ÊòØÂõ†‰∏∫Ëã±ËØ≠Âê¨ÂäõËñÑÂº±Ôºå‰∏ÄÊñπÈù¢ÊòØÂÜÖÂÆπÈúÄË¶ÅÂ•ΩÂ•ΩÂïÉÔºå‰ΩÜÊòØÂú®ËøôÊó∂Èó¥ÈáåÈù¢ÔºåÊàëËøòÊòØÊµ™Ë¥π‰∫ÜÂæàÂ§öÁöÑÊó∂Èó¥ÔºåÁâπÂà´ÊòØ‰∏äËØæÊó∂Èó¥ÔºåÂÆùË¥µÁöÑÊó∂Èó¥ÂèØËÉΩÂ§ßÈÉ®ÂàÜÊ≤°ÊúâÂê¨ÊáÇÂ∞±ËøõÂÖ•‰∫ÜÂèëÂëÜÁä∂ÊÄÅÔºåËøôÁßçÁä∂ÊÄÅÈúÄË¶Å‰∏•Ê†ºÊùúÁªùÔºåÂÖ∂ÂÆûÊ≤°Êúâ‰ªª‰ΩïÁöÑÁêÜÁî±‰∏çËÆ§ÁúüÁöÑÔºåÂè™ÊòØÊúâÊó∂ÂÄôÂê¨Á¥Ø‰∫ÜÔºåÊ≤°Êúâ‰ªîÁªÜÔºåËÆ§ÁúüÁöÑÈîªÁÇºËá™Â∑±ÁöÑÂè£ËØ≠ÔºåÂê¨ÂäõÔºåÈòÖËØªÔºåÊòØÊàëËøôÊÆµÊó∂Èó¥ÁöÑË¥•Á¨îÔºåËøôÁÇπ‰∏äÈù¢ÊàëÈúÄË¶ÅÂ•ΩÂ•ΩÁöÑÊ£ÄËÆ®‰∏Ä‰∏ãËá™Â∑±ÔºåÊØïÁ´üÂ¶ÇÊûúÊÉ≥Âú®ËøôËæπÁ´ãË∂≥ÔºåËã±ËØ≠Âè£ËØ≠„ÄÅÂê¨Âäõ„ÄÅÈòÖËØªÊòØÂøÖÈ°ªËøáÂÖ≥ÁöÑÔºå‰∏çÁÆ°ÊÄé‰πàËØ¥ÈÉΩÈúÄË¶ÅÂº∫Âà∂Ëá™Â∑±ÂéªÁªÉ‰π†ÔºåÂè™ÊúâÈÄöËøá‰∏çÊñ≠ÁöÑÁªÉ‰π†ÊâçËÉΩ‰∏çÊñ≠ÁöÑËøõÊ≠•„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊÄªÁöÑËØ¥Êù•ÂèØËÉΩËøòÊòØÁõ∏ÂØπÁÆÄÂçïÔºåÂ∞±ÊòØÂÅö‰∫Ü‰∏Ä‰∏™projectÔºàÊØîËæÉÁÆÄÂçïÔºâÔºåÁÑ∂ÂêéÂ≠¶‰∫Ü‰∏§Èó®ËØæÔºåÂú®ËøôËæπÊúÄÂ§ßÁöÑÊî∂Ëé∑ÊòØÈ¢ÜÁï•‰∫Ü‰∏ÄÁï™Â≠¶ÊúØÁïåÁöÑÈ£éÈááÔºåÁü•ÈÅìÂ≠¶ÊúØÁïåÁöÑÂÖ∑‰ΩìÂ∑•‰ΩúËøòÊòØÊå∫‰∏çÂÆπÊòìÁöÑÔºåÁü•ÈÅì‰∫ÜÁßëÁ†îÁöÑ‰∫∫ÈÉΩÂú®ÂÅö‰ªÄ‰πàÔºåÂÖ∂ÂÆûÂÅösystemÁ°ÆÂÆûÈùûÂ∏∏ÁöÑËâ∞ÈöæÔºåÈúÄË¶ÅËá™Â∑±ÂéªÊâæÊñπÂêëÔºåËøôÂØπ‰∫é‰∏Ä‰∏™Ê≤°Êúâ‰ªª‰ΩïÁßØÁ¥ØÁöÑ‰∫∫Êù•ËØ¥ÊòØ‰∏Ä‰∏™ÊûÅÂ§ßÁöÑÊåëÊàòÔºåÊâÄ‰ª•ÊúâÊó∂ÂÄôÈúÄË¶ÅÊÖ¢‰∏ãÊù•ÔºåËøôÊÆµÊó∂Èó¥ÊóÅÂê¨‰∫ÜÈÇ£‰πà‰πÖÁöÑÂ≠¶Èïø‰ª¨ÁöÑ‰ºöËÆÆÔºåÂØπ‰ªñ‰ª¨ÁöÑ‰∏úË•ø‰πüÊúâ‰∫ÜÂ§ßËá¥ÁöÑ‰∫ÜËß£ÔºåÊàëËßâÂæóÁ°ÆÂÆûËøòÊòØÊå∫ÊúâÊî∂Ëé∑ÔºåÂØπ‰∫éÂºÄÊ∫êÈ°πÁõÆÔºåÂºÄÊ∫êÂ∑•ÂÖ∑ÁöÑÂéüÁêÜ„ÄÅÊ∫êÁ†ÅÁöÑÈòÖËØªËÆ©Êàë‰ª•ÂêéÁü•ÈÅì‰∫ÜÂ¶Ç‰ΩïÂØπ‰∏Ä‰∏™Êú™Áü•ÁöÑ‰∏úË•øËøõË°åÂ§ÑÁêÜÔºåÂ∞±ÁÆóÊòØdocumentÁúã‰∏çÊáÇÔºå‰πüÊúâÊ∫êÁ†ÅÂèØ‰ª•ÈòÖËØªÔºå‰∏çÂè™ÊòØÁúãAPIÁöÑÊ∫êÁ†ÅÔºå‰πüÂèØ‰ª•ÁúãÊ†∏ÂøÉ‰ª£Á†ÅÔºåÁúãÁúãÂèÇÊï∞‰º†ÈÄíÔºåÁúãÁúãÊï¥‰∏™ÁªÜËäÇÁöÑÈÄªËæëÔºåÊÉ≥ÊÉ≥‰∏∫‰ªÄ‰πàËøôÂÑøËÆæËÆ°Á≠âÁ≠âÔºåÊÑüËß¶ÂæàÊ∑±Ôºå‰πüÊ∑±Áü•Ëá™Â∑±‰∏é‰ªñ‰ª¨ËøòÊòØÊúâÂ∑ÆË∑ùÁöÑÔºåÊàëÈúÄË¶ÅÂ•ΩÂ•ΩÁöÑÂä™ÂäõÔºåÂ∞ΩÈáèÁº©Â∞èËøô‰∏™Â∑ÆË∑ùÔºåÊâÄ‰ª•ÂØπÊàëÊù•ËØ¥ÔºåÁßëÁ†îÊòØÂøÖÈ°ªË¶ÅÂ•ΩÂ•ΩÁßØÁ¥ØÁöÑÔºåÂõûÂéªÁöÑËøôÊÆµÊó∂Èó¥‰πü‰∏çËÉΩÊîæÊùæÔºåÈúÄË¶ÅÂ•ΩÂ•ΩÁöÑÁ†îÁ©∂‰∏Ä‰∏ãÂàÜÂ∏ÉÂºèÁ≥ªÁªüÔºåÁ†îÁ©∂ÂàÜÂ∏ÉÂºè‰ªªÂä°Ë∞ÉÂ∫¶Á≠âÈóÆÈ¢òÔºåËøôÊ†∑ÂèØ‰ª•ÊúâÊõ¥Â§öÁöÑÊú∫‰ºöÂèëÁé∞‰∏Ä‰∏™Â•ΩÁöÑideaÔºåÂØπ‰∫éPHDÊù•ËØ¥ÔºåÂèØËÉΩ‰∏Ä‰∏™ideaÊòØÈùûÂ∏∏ÈáçË¶ÅÁöÑÂêßÔºåÂ≠¶Èïø‰ª¨Âä†Ê≤πÔºåÊàëËá™Â∑±‰πüÂä†Ê≤π„ÄÇ&lt;/p&gt;

&lt;p&gt;ÂõûÂéªÁöÑÊó∂Èó¥ÈáåÔºåÈ¶ñÂÖàË¶ÅÊéåÊè°Samza standaloneÊ∫êÁ†ÅÔºåÁÑ∂ÂêéÊòØYARNÂéüÁêÜ„ÄÅÊ∫êÁ†ÅÈòÖËØªÔºåÊàëËßâÂæóËøôÊ¨°ÂèØ‰ª•Áî®SparkÂÅö‰∏Ä‰∫õÂÆûÈ™åËøõË°åYARNÁöÑÁêÜËß£ÔºåËøôÊ†∑Â∫îËØ•ËÉΩÂä†Ê∑±ÊàëÂØπSparkÁöÑÁêÜËß£‰ª•ÂèäÂØπYARNÁöÑÁêÜËß£Ôºå‰πãÂâçÂè™Áî®ËøáSamzaÔºåÊâÄ‰ª•ËøòÊòØË¶ÅÂ•ΩÂ•ΩËØï‰∏Ä‰∏ãÂÖ∂‰ªñ‰∏úË•øÂë¢ÔºåÁé∞Âú®Ëá™Â∑±ËøòÊòØÂ§Ñ‰∫é‰∏Ä‰∏™low levelÁöÑÈò∂ÊÆµÔºåÈúÄË¶Å‰∏çÊñ≠ÁöÑË°•ÂÖÖËøô‰∏™ÊñπÂêëÁöÑÂü∫Á°ÄÔºåÊâìÁâ¢Âü∫Á°ÄÔºåÊâçËÉΩÂêëÂâçËµ∞ÔºåÂéöÁßØËÄåËñÑÂèëÔºåÁªÉ‰π†Ëã±ËØ≠Ëøô‰∏™ÊòØÈùûÂ∏∏ÊúâÂøÖË¶ÅÁöÑÔºåÂÜôÁöÑÊØèÂè•ËØùÈÉΩÈúÄË¶ÅÂ•ΩÂ•ΩÊÉ≥ÊÉ≥ÔºåÂèçÂ§çÊñüÈÖåÊâçË°åÔºå‰∏çÁÑ∂Ê≤°Êúâ‰ªª‰ΩïÊòØËøõÊ≠•ÁöÑ„ÄÇ&lt;/p&gt;

&lt;p&gt;‰ΩÜÊÑøËøôÊ¨°ËÉΩÂ§üÈ°∫Âà©ËøõÂÖ•masterÁöÑÊîªËØªÔºåÁÑ∂ÂêéÈ°∫Âà©ËøõÂÖ•PHDÔºågod bless me.&lt;/p&gt;
</description>
        <pubDate>Thu, 10 May 2018 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2018/05/10/NGNE%E6%80%BB%E7%BB%93/</link>
        <guid isPermaLink="true">http://localhost:4000/2018/05/10/NGNE%E6%80%BB%E7%BB%93/</guid>
        
        
      </item>
    
      <item>
        <title>LatexÂ≠¶‰π†Á¨îËÆ∞</title>
        <description>&lt;h1 id=&quot;latexÂ≠¶‰π†Á¨îËÆ∞&quot;&gt;latexÂ≠¶‰π†Á¨îËÆ∞&lt;/h1&gt;

&lt;h3 id=&quot;ÁéØÂ¢ÉÊê≠Âª∫&quot;&gt;ÁéØÂ¢ÉÊê≠Âª∫&lt;/h3&gt;

&lt;p&gt;‰πãÂâç‰ΩøÁî®mikTex + Texmaker
Áé∞Âú®‰ΩøÁî®sublime + mikTex + pdfviewer&lt;/p&gt;

&lt;h3 id=&quot;ËØ≠Ê≥ïÂ≠¶‰π†&quot;&gt;ËØ≠Ê≥ïÂ≠¶‰π†&lt;/h3&gt;

&lt;h4 id=&quot;documentclassarticle&quot;&gt;\documentclass{article}&lt;/h4&gt;

&lt;p&gt;ËøôÁØáÊñáÊ°£ÁöÑÁ±ªÂûãÊòØÂ≠¶ÊúØÊñáÁ´†ÔºåÈô§Ê≠§‰πãÂ§ñ‰πüÊúâbookÔºåbookletÁ≠âÂÖ∂‰ªñÂá∫ÁâàÁâ©Á±ªÂûãÔºåËøô‰∏ÄÂè•ÈôêÂÆö‰∫ÜÊéíÁâàËÉΩÂ§ü‰ΩøÁî®ÁöÑÊ†ºÂºèÔºåÊØîÂ¶ÇËØ¥Â¶ÇÊûúÁ±ªÂûãÊòØarticleÔºåÈÇ£‰πàÊéíÁâàÂ∞±ÂèØ‰ª•Áî®APA/Chicago/MLAÁ≠âÁâàÂºèÔºåËÄå‰∏çÊòØ‰∏ìÁî®‰∫ébookletÁöÑ‰∏Ä‰∫õÁâàÂºèÔºõ&lt;/p&gt;

&lt;h4 id=&quot;userpackage&quot;&gt;\userpackage&lt;/h4&gt;

&lt;p&gt;Â∫îËØ•ÊòØÂºïÁî®ÂêÑÁßçÂåÖÁöÑapiÔºåËøô‰∏™ËÇØÂÆöÂ∞±ÊØîËæÉ‰∏™ÊÄßÂåñ‰∫Ü„ÄÇÂèØ‰ª•ËÆ∞ÂΩïÂá†‰∏™ÊØîËæÉÈÄöÁî®ÁöÑ&lt;/p&gt;

&lt;p&gt;ÊñáÂ≠óÊéíÁâàÊòØnatbib&lt;/p&gt;

&lt;p&gt;ÂõæË°®ÊéíÁâàÊòØgraphicx &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;\includegraphics[scale=0.4]{t1.jpg}&lt;/code&gt;&lt;/p&gt;

&lt;h4 id=&quot;title&quot;&gt;\title&lt;/h4&gt;

&lt;p&gt;ÊòØÊï¥‰∏™ÊñáÊ°£ÁöÑÊ†áÈ¢òÔºå‰ºöËá™Âä®Â±Ö‰∏≠„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;authorÂíådate&quot;&gt;\authorÂíå\date&lt;/h4&gt;

&lt;p&gt;ÊòØÊñáÊ°£ÁöÑ‰ΩúËÄÖÂíåÊó•Êúü‰ø°ÊÅØÔºåÂ¶ÇÊûúÊÉ≥ËÆ©dateËá™Âä®ÊòæÁ§∫‰ªäÂ§©ÁöÑÊó•ÊúüÔºåÂ∞±ÊääËøô‰∏ÄË°åÊîπ‰∏∫\date{\today}„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;begindocument&quot;&gt;\begin{document}&lt;/h4&gt;

&lt;p&gt;ÊòØÊ≠£ÊñáÊ≠£ÂºèÁöÑÂºÄÂßãÊ†áÂøó„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;maketitle&quot;&gt;\maketitle&lt;/h4&gt;

&lt;p&gt;ÂëΩ‰ª§ÁöÑ‰ΩúÁî®ÊòØÊääÊ†áÈ¢ò‰ø°ÊÅØ‰πãÂâçÁöÑ\titleÔºå\authorÔºå\dateÁ≠âÊòæÁ§∫Âá∫Êù•„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;newenvironment&quot;&gt;\newenvironment&lt;/h4&gt;

&lt;p&gt;Êñ∞Âª∫ÁéØÂ¢É\newenvironment{name}[num]{before}{after}&lt;/p&gt;

&lt;h3 id=&quot;beginparam&quot;&gt;\begin{param}&lt;/h3&gt;

&lt;p&gt;param: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;enumerate&lt;/code&gt; Êûö‰∏æÈªòËÆ§‰∏∫Êï∞Â≠óÔºåÂèØ‰ª•ËÆæÁΩÆÂ≠óÊØç&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;\begin{enumerate}[label=\alph*)]&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;ÂèØ‰ª•ËÆæÁΩÆÂæàÂ§öÔºåÁõÆÂâçÊúÄÂ§öÁöÑÊòØËá™ÂÆö‰πâÁöÑÁéØÂ¢ÉÔºåÊÑüËßâbeginÊòØ‰∏Ä‰∏™ÊÆµÂºÄÂßãÔºåÈáåÈù¢ÁöÑparamÂ∞±ÊòØÂ∏ÆÂä©ÂàùÂßãÂåñÊ†ºÂºèÁöÑ„ÄÇ&lt;/p&gt;
</description>
        <pubDate>Sun, 04 Feb 2018 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2018/02/04/latex%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</link>
        <guid isPermaLink="true">http://localhost:4000/2018/02/04/latex%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</guid>
        
        
      </item>
    
      <item>
        <title>StormÂ≠¶‰π†Á¨îËÆ∞</title>
        <description>&lt;h2 id=&quot;storm&quot;&gt;Storm&lt;/h2&gt;

&lt;h3 id=&quot;concept&quot;&gt;concept&lt;/h3&gt;

&lt;p&gt;stormÂ∑•Á®ãÁªìÊûÑÔºånimbusÁ±ª‰ºº‰∫émasterÔºåsupervisorÁ±ª‰ºº‰∫éslave„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://www.aboutyun.com/data/attachment/forum/201404/15/225641mt3v1okkkrkkp3rk.jpg&quot; alt=&quot;img&quot; /&gt;&lt;/p&gt;

&lt;p&gt;topologyÔºöstorm‰∏≠ÁöÑjobÔºåÂåÖÊã¨‰∏§Á±ªÁªÑ‰ª∂spoutÂíåbolt&lt;/p&gt;

&lt;p&gt;spoutÂèØ‰ª•ÈõÜÊàêÊ∂àÊÅØÈòüÂàóÂíåÊï∞ÊçÆÂ∫ìÁ≥ªÁªüÔºå‰ªé‰∏≠Ëé∑ÂèñÊï∞ÊçÆÔºåÂèØ‰ª•‰ªérabbitMQÔºåkestrelÔºåAMQPÔºåKafkaÁ≠âËé∑Âèñ„ÄÇÊòØÊµÅÊï∞ÊçÆÊ∫êÂ§¥ÔºåÊÑèÊÄùÊòØÂÆÉÁ±ª‰ºº‰∫éproducer&lt;/p&gt;

&lt;p&gt;boltÂèØ‰ª•ËøûÊé•Êï∞ÊçÆÂ∫ìËøõË°åÊìç‰Ωú„ÄÇ‰æãÂ¶ÇNoSQLÁöÑcassandraÔºårdbmsÔºåÊòØÊé•ÂèóÊµÅÊï∞ÊçÆÂ§ÑÁêÜÁöÑ‰ΩúÁî®ÔºåÁ±ª‰ºº‰∫éconsumerÔºåÂèØ‰ª•Â§ÑÁêÜÊµÅÊï∞ÊçÆ„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://www.aboutyun.com/data/attachment/forum/201404/15/225643pjbhjccbkt94cmst.png&quot; alt=&quot;img&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;Á≥ªÁªüÁªìÊûÑ&quot;&gt;Á≥ªÁªüÁªìÊûÑ&lt;/h3&gt;

</description>
        <pubDate>Sun, 24 Dec 2017 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2017/12/24/storm%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/12/24/storm%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</guid>
        
        
      </item>
    
      <item>
        <title>SamzaÂ≠¶‰π†Á¨îËÆ∞</title>
        <description>&lt;h3 id=&quot;samza&quot;&gt;Samza&lt;/h3&gt;

&lt;h3 id=&quot;samza-1&quot;&gt;Samza&lt;/h3&gt;

&lt;p&gt;Samza is a stream processing framework with the following features:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;Simple API:&lt;/strong&gt; Unlike most low-level messaging system APIs, Samza provides a very simple callback-based ‚Äúprocess message‚Äù API comparable to MapReduce.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Managed state:&lt;/strong&gt; Samza manages snapshotting and restoration of a stream processor‚Äôs state. When the processor is restarted, Samza restores its state to a consistent snapshot. Samza is built to handle large amounts of state (many gigabytes per partition).&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Fault tolerance:&lt;/strong&gt; Whenever a machine in the cluster fails, Samza works with YARN to transparently migrate your tasks to another machine.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Durability:&lt;/strong&gt; Samza uses Kafka to guarantee that messages are processed in the order they were written to a partition, and that no messages are ever lost.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Scalability:&lt;/strong&gt; Samza is partitioned and distributed at every level. Kafka provides ordered, partitioned, replayable, fault-tolerant streams. YARN provides a distributed environment for Samza containers to run in.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Pluggable:&lt;/strong&gt; Though Samza works out of the box with Kafka and YARN, Samza provides a pluggable API that lets you run Samza with other messaging systems and execution environments.&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Processor isolation:&lt;/strong&gt; Samza works with Apache YARN, which supports Hadoop‚Äôs security model, and resource isolation through Linux CGroups.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;http://ox0pxbncm.bkt.clouddn.com/17-11-22/98296127.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;samzaËøêË°åÂéüÁêÜ&quot;&gt;samzaËøêË°åÂéüÁêÜ&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;http://img.blog.csdn.net/20150918145544673&quot; alt=&quot;ËøôÈáåÂÜôÂõæÁâáÊèèËø∞&quot; /&gt;&lt;/p&gt;

&lt;p&gt;SamzaÁöÑJobÊòØËøêË°åÂú®Yarn‰∏äÁöÑ„ÄÇ&lt;/p&gt;

&lt;p&gt;Êû∂ÊûÑÂõæ‰∏≠Â±ïÁé∞ÁöÑÊòØÊèê‰∫§2‰∏™JobÁ§∫‰æã„ÄÇ 
Êèê‰∫§‰∏Ä‰∏™JobÁöÑÂü∫Êú¨ËøáÁ®ãÔºö 
-  ClientÂ∞ÜJobÊèê‰∫§Âà∞RMÔºà‰ΩøÁî®YarnClient Á±ªÔºâ
- RMÊ†πÊçÆÂΩìÂâçËµÑÊ∫êÂàÜÈÖçNode ManagerËµÑÊ∫êËøêË°åApp Master
- App MasterÂêëRMÁî≥ËØ∑ËøêË°åContainerÁöÑNode ManagerËµÑÊ∫êÔºåÂæóÂà∞ËµÑÊ∫êÂêéËøêË°åContainer 
- Container‰∏≠ÊâßË°å‰Ω†Êèê‰∫§ÁöÑJob&lt;/p&gt;

&lt;p&gt;ÂèØ‰ª•ÁúãÂá∫Ë¶ÅÂú®Yarn‰∏äËøêË°å‰∏Ä‰∏™JobÈúÄË¶ÅÊúâ‰∏âÊ†∑‰∏úË•øÔºö 
- ClientÔºöÊèê‰∫§JobÂà∞Yarn‰∏ä 
- App MasterÔºöÁî≥ËØ∑ËµÑÊ∫ê„ÄÅÂêØÂä®Container 
- ContainerÔºöËøêË°åÁ®ãÂ∫èÔºàÊàë‰ª¨ÂÜôÁöÑÂ§ÑÁêÜÁ®ãÂ∫èÂ∞±Âú®ËøôÈáåËøêË°åÔºâ&lt;/p&gt;

&lt;p&gt;SamzaÊòØÂ¶Ç‰ΩïÂ∞ÜJobËøêË°åÂú®Yarn‰∏äÁöÑ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://img.blog.csdn.net/20150917171623774&quot; alt=&quot;SamzaÁöÑJobÊèê‰∫§ËøáÁ®ã&quot; /&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Âú®Samza‰∏≠ÊòØÂà©Áî®JobRunnerÊèê‰∫§JobÂà∞RM‰∏≠ÁöÑÔºå&lt;strong&gt;Áî±‰∫éSamzaÂØπ‰∫éYarn„ÄÅKafkaÊòØÂèØÊèíÊãîÁöÑÔºàpluggableÔºâ&lt;/strong&gt;ÔºåÂõ†Ê≠§Âú®Ê≠§Â§ÑË∞ÉÁî®‰∫ÜYarnJobÁ±ªÂÆûÈôÖÂÆåÊàêËøô‰∏™ÂäüËÉΩÁöÑ„ÄÇ&lt;/li&gt;
  &lt;li&gt;Samza‰∏≠ÁöÑAppMasterÂ∞±ÊòØSamzaAppMasterÁ±ªÔºåËØ•Á±ª‰∏éRMÈÄö‰ø°ÔºåÁî≥ËØ∑ËµÑÊ∫êÔºå‰∏éNMÈÄö‰ø°ÂêØÂä®Ëá™Â∑±ÁöÑContainer‚ÄîSamzaContainer&lt;/li&gt;
  &lt;li&gt;SamzaContainerÂêØÂä®ÂêéÔºå‰ºöÊâßË°åÊàë‰ª¨ÂÜôÁöÑTask„ÄÇ&lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&quot;clientÊèê‰∫§jobÂêØÂä®samzaappmasterÁöÑËøáÁ®ã&quot;&gt;ClientÊèê‰∫§JobÔºåÂêØÂä®SamzaAppMasterÁöÑËøáÁ®ã&lt;/h4&gt;

&lt;p&gt;&lt;img src=&quot;http://img.blog.csdn.net/20150918151755538&quot; alt=&quot;SamzaAppMsterÂêØÂä®ÁöÑËøáÁ®ã&quot; /&gt;&lt;/p&gt;

&lt;p&gt;SamzaÊòØÂà©Áî®bin/run-job.shÊèê‰∫§JobÁöÑÔºå‰æãÔºàhello-samza‰∏≠Êèê‰∫§JobÔºâÔºö&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;deploy/samza/bin/run-job.sh &lt;span class=&quot;nt&quot;&gt;--config-factory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;org.apache.samza.config.factories.PropertiesConfigFactory &lt;span class=&quot;nt&quot;&gt;--config-path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;file://&lt;span class=&quot;nv&quot;&gt;$PWD&lt;/span&gt;/deploy/samza/config/wikipedia-feed.properties
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ËÑöÊú¨ÂÆûÈôÖË∞ÉÁî®org.apache.samza.job.JobRunnerÊù•Ëß£ÊûêÈÖçÁΩÆÊñá‰ª∂Ôºå‰ª•ÂèäÊèê‰∫§JobÁöÑ„ÄÇ 
run-job.shÁöÑÂÜÖÂÆπÔºö&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt; &lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;dirname&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$0&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;/run-class.sh &lt;span class=&quot;k&quot;&gt;**&lt;/span&gt;org.apache.samza.job.JobRunner&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$@&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Áî±‰∫éÈÖçÁΩÆÊñá‰ª∂‰∏≠&lt;code&gt;job.factory.class=org.apache.samza.job.yarn.YarnJobFactory&lt;/code&gt;(ËØ•Â§ÑÂèØ‰ª•ÈÖçÁΩÆProcessJobFactoryÊàñËÄÖThreadJobFactoryÔºå‰ΩÜÊàëÂè™ÂàÜÊûêËøêË°åÂú®Yarn‰∏äÁöÑÊÉÖÂÜµ)ÔºåÂõ†Ê≠§Âú®JobRunner‰∏≠ÂÆûÈôÖË∞ÉÁî®‰∫ÜYarnJobÁöÑsubmit,Âú®submit‰∏≠Ë∞ÉÁî®ÁöÑÊòØYarnClientÁöÑsubmitApplicationÊñπÊ≥ïÔºåyarnÊèê‰æõapi submitApplicationÂ∞Ü‰ªªÂä°‰∏ä‰º†Âà∞yarnÔºåËøô‰∏ÄÂùóÊ≤°Êúâ‰ªîÁªÜÁ†îÁ©∂Ôºå‰∏çËøá‰ª£Á†ÅË∑üË∏™Â∫îËØ•Áõ∏‰ººÔºåyarnÂèëÈÄÅÊåá‰ª§run-am.shÔºåÂàõÂª∫‰∏Ä‰∏™appmasterÔºåËøô‰∏™‰∏ã‰∏ÄÁ´†ËÆ≤„ÄÇÂÖ∂‰∏≠submitApplication‰∏≠Êé•Êî∂‰∫Ü‰∏Ä‰∏™Á±ªÂûã‰∏∫ApplicationSubmissionContextÂèÇÊï∞ÔºåÂÖ∂‰∏≠‰∏ªË¶ÅÂåÖÊã¨packageÔºàÊàë‰ª¨ÂÜôÁöÑÁ®ãÂ∫èÁöÑjarÂåÖÔºâÁöÑpathÔºå‰ª•ÂèäÂêØÂä®SamzaAppMasterÂëΩ‰ª§Ë°å„ÄÇËØ¶ÁªÜ‰ª£Á†ÅÔºö&lt;/p&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;submit&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;YarnJob&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;appId&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;submitApplication&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*ÂÆûÈôÖË∞ÉÁî®ÁöÑÊòØYarnClientÁöÑsubmitApplicationÔºåYarnClientËøô‰∏™Á±ª‰∏ªË¶ÅÊòØÂ∞ÜjobÊèê‰∫§ÁªôYarnÁöÑRM*/&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getPackagePath&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getOrElse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SamzaException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;No YARN package path defined in config.&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)))&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*APKÁöÑË∑ØÂæÑÔºå‚ë†httpÂèØ‰ª•‰∏ãËΩΩÁöÑurl‚ë°hdfsÁöÑË∑ØÂæÑ*/&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getAMContainerMaxMemoryMb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getOrElse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;DEFAULT_AM_CONTAINER_MEM&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt;
      &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;nc&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;s&quot;&gt;&quot;export SAMZA_LOG_DIR=%s &amp;amp;&amp;amp; ln -sfn %s logs &amp;amp;&amp;amp; exec ./__package/bin/run-am.sh 1&amp;gt;logs/%s 2&amp;gt;logs/%s&quot;&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*YarnÁöÑRM‰ºöÊâßË°årun-am.shÊù•ÂêØÂä®SamzaÁöÑSamzaAppMaster*/&lt;/span&gt;
          &lt;span class=&quot;nf&quot;&gt;format&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ApplicationConstants&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;LOG_DIR_EXPANSION_VAR&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ApplicationConstants&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;LOG_DIR_EXPANSION_VAR&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ApplicationConstants&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;STDOUT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ApplicationConstants&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;STDERR&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)),&lt;/span&gt;
      &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;({&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;envMap&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
          &lt;span class=&quot;nv&quot;&gt;ShellCommandConfig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;ENV_CONFIG&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;Util&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;envVarEscape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;SamzaObjectMapper&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getObjectMapper&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;writeValueAsString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)),&lt;/span&gt;
          &lt;span class=&quot;nv&quot;&gt;ShellCommandConfig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;ENV_JAVA_OPTS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;Util&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;envVarEscape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getAmOpts&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getOrElse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)))&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;envMapWithJavaHome&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getAMJavaHome&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;match&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;javaHome&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;envMap&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ShellCommandConfig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;ENV_JAVA_HOME&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;javaHome&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*‰∏Ä‰∫õÁéØÂ¢ÉÂèòÈáè*/&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;envMap&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;envMapWithJavaHome&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;}),&lt;/span&gt;

      &lt;span class=&quot;nc&quot;&gt;Some&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;%s_%s&quot;&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;format&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getJobId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getOrElse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))))&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;appCtx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;setAMContainerSpec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;containerCtx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;appCtx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;setApplicationType&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ClientHelper&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;applicationType&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;submitting application request for %s&quot;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;format&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;appId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;yarnClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;submitApplication&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;appCtx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Âà∞ÁõÆÂâç‰∏∫Ê≠¢ÔºåÂ∑≤ÁªèÂ∞ÜÊàë‰ª¨ÁöÑJobÊèê‰∫§ÁªôYarnÁöÑRMÔºåÂπ∂‰∏îRMÂèØ‰ª•ÂêØÂä®SamzaAppMaster„ÄÇ&lt;/p&gt;

&lt;h4 id=&quot;samzaappmasterÁî≥ËØ∑ËµÑÊ∫êÂêØÂä®containerÁöÑËøáÁ®ã&quot;&gt;SamzaAppMasterÁî≥ËØ∑ËµÑÊ∫ê„ÄÅÂêØÂä®ContainerÁöÑËøáÁ®ã&lt;/h4&gt;

&lt;p&gt;SamzaAppMasterÂÆûÁé∞‰∫Ü AMRMClientAsync.CallbackHandlerÊé•Âè£„ÄÇËØ•Êé•Âè£ÁöÑ‰ΩúÁî®ÊòØAppMasterÂêëYarnÁöÑRMÁî≥ËØ∑ËµÑÊ∫êÊàêÂäüÂêéÁöÑÂõûË∞ÉÂáΩÊï∞ÔºåÁî®‰ª•ÈÄöÁü•SamzaAppMaster„ÄÇSamzaAppMasterÊé•Âà∞ÈÄöÁü•ÂêéÈÄöÁü•YarnÁöÑNode ManergerÊù•ÂêØÂä®SamzaContainerÔºåËøôÊ†∑Êàë‰ª¨ÁöÑJobÂ∞±‰ºöË¢´ÊâßË°å‰∫Ü„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://img.blog.csdn.net/20150918142727408&quot; alt=&quot;SamzaContainerÂêØÂä®ËøáÁ®ã&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SamzaAppMaster&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Logging&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;AMRMClientAsync&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;CallbackHandler&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;amClient&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;AMRMClientAsync&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;createAMRMClientAsync&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;ContainerRequest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;interval&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*this:Â∞ÜËá™Â∑±Ê≥®ÂÜåÁªôYarnÁöÑRMÔºåÂæÖËµÑÊ∫êÁî≥ËØ∑ÊàêÂäüÂêé‰ºöË∞ÉÁî®Ëá™Â∑±Á±ªÁöÑonContainersAllocated*/&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SamzaAppMasterState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;containerId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nodeHostString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;nodePortString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;toInt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;nodeHttpPortString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;toInt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;service&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SamzaAppMasterService&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;registry&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clientHelper&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;lifecycle&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SamzaAppMasterLifecycle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;containerMem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;containerCpu&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;amClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;metrics&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SamzaAppMasterMetrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;registry&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;am&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SamzaAppMasterTaskManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;({&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;currentTimeMillis&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;amClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hConfig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*Ëøô‰∏™Á±ª‰∏ªË¶Å‰∏éNMÈÄö‰ø°ÔºåÂπ∂ÂêØÂä®Container*/&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;listeners&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;service&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lifecycle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;am&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;nf&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;amClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;listeners&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hConfig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;interval&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/**/&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

 &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;amClient&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;AMRMClientAsync&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;ContainerRequest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;listeners&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;YarnAppMasterListener&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hConfig&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;YarnConfiguration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;interval&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Unit&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;amClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hConfig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;amClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;start&lt;/span&gt;
      &lt;span class=&quot;nv&quot;&gt;listeners&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;foreach&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;onInit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*Ê≠§Â§ÑÂêØÂä®ÊâÄÊúâÁõëÂê¨ÂíåÊúçÂä°Ôºå‰πüÂêØÂä®‰∫ÜSamzaAppMasterTaskManagerÁ±ª*/&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;


  &lt;span class=&quot;k&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;onContainersAllocated&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;containers&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;java.util.List&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;Container&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Unit&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;containers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;foreach&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;container&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;listeners&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;foreach&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;onContainerAllocated&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;container&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)))&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*ËµÑÊ∫êÁî≥ËØ∑ÊàêÂäüÔºåYarn ÁöÑRMÁöÑÂõûË∞ÉÔºàÂõæ‰∏≠ÁöÑ3ÔºâÔºåÁúüÊ≠£ÂêØÂä®SamzaContainerÁöÑÊòØSamzaAppMasterTaskManagerÁ±ª‰∏≠ÁöÑonContainerAllocatedÂáΩÊï∞*/&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;--------------------------------------------------------------------&lt;/span&gt;
&lt;span class=&quot;nc&quot;&gt;SamzaAppMasterTaskManagerÁ±ª&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;Ôºö&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;onInit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;neededContainers&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;taskCount&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;unclaimedTasks&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;jobCoordinator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;jobModel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getContainers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;keySet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;toInt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;toSet&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;containerManager&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;NMClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;createNMClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;containerManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;conf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;containerManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*Âª∫Á´ã‰∏éNMÁöÑÈÄö‰ø°*/&lt;/span&gt;

    &lt;span class=&quot;nf&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Requesting %s containers&quot;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;format&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;taskCount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nf&quot;&gt;requestContainers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getContainerMaxMemoryMb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getOrElse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;DEFAULT_CONTAINER_MEM&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getContainerMaxCpuCores&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getOrElse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;DEFAULT_CPU_CORES&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;neededContainers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*ÂêëRMÁî≥ËØ∑ËµÑÊ∫êÔºàÂõæ‰∏≠ÁöÑ1.1Ôºâ*/&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;override&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;onContainerAllocated&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;container&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Container&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*ContainerÁî≥ËØ∑ÊàêÂäüÂêéÁöÑÂõûË∞ÉÂáΩÊï∞*/&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
 &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;cmdBuilderClassName&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getCommandClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getOrElse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;classOf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;ShellCommandBuilder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*Ëé∑ÂæóShellCommandBuilderÁ±ªÔºåÊ≠§Á±ª‰∏≠ÂåÖÂê´ÂêØÂä®SamzaContainerÁöÑËÑöÊú¨ÂëΩ‰ª§*/&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;cmdBuilder&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;Class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;forName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmdBuilderClassName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;newInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;asInstanceOf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;CommandBuilder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
          &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;setConfig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;setId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;taskId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;setUrl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;coordinatorUrl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;command&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;cmdBuilder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;buildCommand&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*ÂæóÂà∞ÁöÑÂ∞±ÊòØbin/run-container.sh*/&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
 &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;cmdBuilderClassName&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getCommandClass&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getOrElse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;classOf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;ShellCommandBuilder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;cmdBuilder&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;Class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;forName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmdBuilderClassName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;newInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;asInstanceOf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;CommandBuilder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;
          &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;setConfig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;setId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;taskId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;setUrl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;coordinatorUrl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;command&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;cmdBuilder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;buildCommand&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;

 &lt;span class=&quot;nf&quot;&gt;startContainer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*Ë∞ÉÁî®ÂÜÖÈÉ®ÂáΩÊï∞ÔºåÂÆûÈôÖË∞ÉÁî®ÁöÑÊòØNMClient.createNMClient().startContainer()*/&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*Êàë‰ª¨Êèê‰∫§ÁöÑPKGÁöÑË∑ØÂæÑ*/&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;container&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;nv&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;toMap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
          &lt;span class=&quot;s&quot;&gt;&quot;export SAMZA_LOG_DIR=%s &amp;amp;&amp;amp; ln -sfn %s logs &amp;amp;&amp;amp; exec ./__package/%s 1&amp;gt;logs/%s 2&amp;gt;logs/%s&quot;&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;format&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;ApplicationConstants&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;LOG_DIR_EXPANSION_VAR&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ApplicationConstants&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;LOG_DIR_EXPANSION_VAR&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;command&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*Ê≠§Â§ÑÂ∞ÜÂêØÂä®SamzaContainerÁöÑËÑöÊú¨‰º†ÈÄíÁªôNMÔºåNMÂæóÂà∞PKGÁöÑË∑ØÂæÑÂêéÂ∞ÜPKGËß£ÂéãÔºå‰πãÂêéÂ∞±ÂèØ‰ª•ÊâßË°åËÑöÊú¨ÂêØÂä®Container*/&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ApplicationConstants&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;STDOUT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ApplicationConstants&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;STDERR&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;


 &lt;span class=&quot;k&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;startContainer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;packagePath&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;container&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Container&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmds&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;String*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
 &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
   &lt;span class=&quot;nv&quot;&gt;containerManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;startContainer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;container&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ctx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;samzacontainerËøêË°åtaskÁöÑËøáÁ®ã&quot;&gt;SamzaContainerËøêË°åTaskÁöÑËøáÁ®ã&lt;/h4&gt;

&lt;p&gt;ÂÖ∑‰ΩìÊâßË°åÁöÑËøáÁ®ãSamzaContainer‚Äì&amp;gt;main‚Äì&amp;gt;safeMain‚Äì&amp;gt;apply‚Äì&amp;gt;run‚Äì&amp;gt;RunLoop.run‚Äì&amp;gt;RunLoop.process 
Ëß£ÈáäÔºö 
1„ÄÅmain: mainÊòØÈªòËÆ§Ë¢´ÊâßË°åÁöÑÔºåÈáåÈù¢Áõ¥Êé•Ë∞ÉÁî®‰∫ÜsafeMain 
2„ÄÅsafeMain: Âú®safeMainÊúÄÂêéË∞ÉÁî®‰∫ÜObjectÁöÑSamzaContainer(containerModel, jobModel).run 
3„ÄÅapply: Áî±‰∫éSamzaContainerÊòØObjectÔºåÈÇ£‰πàÈ¶ñÂÖà‰ºöÈªòËÆ§‰ºöÊâßË°åapplyÔºåÂú®apply‰∏≠‰∏ªË¶ÅÊòØÂØπ‰∏Ä‰∫õÂèòÈáèËµãÂÄº„ÄÅÂàùÂßãÂåñÔºåÂåÖÊã¨ÂàùÂßãÂåñTaskÂÆû‰æã 
4„ÄÅrun: Âú®run‰∏≠‰∏ªË¶ÅÂºÄÂßãÂØπÊ∂àÊÅØÂºÄÂßãËΩÆËÆ≠Â§ÑÁêÜ 
5„ÄÅRunLoop.run: RunLoop.runËøô‰∏™ÊòØÁúüÊ≠£ÂêëprocessÈáåËØªÂèñÊï∞ÊçÆÁöÑÁ∫øÁ®ã 
6„ÄÅRunLoop.process: RunLoop.process‰ºöÊúÄÁªàË∞ÉÁî®Êàë‰ª¨ÂÜôÁöÑÂáΩÊï∞&lt;/p&gt;

&lt;p&gt;SamzaContainerÊ∫êÁ†ÅÂà∞applyÔºö&lt;/p&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SamzaContainer&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Logging&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Array&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nf&quot;&gt;safeMain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;JmxServer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SamzaContainerExceptionHandler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)))&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;safeMain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;jmxServer&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;newJmxServer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
      &lt;span class=&quot;nc&quot;&gt;SamzaContainer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;containerModel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;jobModel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*ËøôÈáåÂºÄÂßãÊâßË°å‰∫Ü*/&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;/*---------------------------------------------------*/&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;/*applyÂáΩÊï∞ÔºöÂàùÂßãÂåñTaskÂÆû‰æã*/&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;apply&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;containerModel&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;ContainerModel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;jobModel&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;JobModel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;taskClassName&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getTaskClass&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getOrElse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SamzaException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;No task class defined in configuration.&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;cm&quot;&gt;/*Ëé∑ÂèñÈÖçÁΩÆÊñá‰ª∂‰∏≠ÁöÑval TASK_CLASS = &quot;task.class&quot; // streaming.task-factory-class*/&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;/*‰∏ãÈù¢Â∞±ÊòØËé∑ÂèñTaskÁöÑÂÆû‰æã*/&lt;/span&gt;
 &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;taskInstances&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;TaskName&lt;/span&gt;, &lt;span class=&quot;kt&quot;&gt;TaskInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;containerModel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getTasks&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;taskModel&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;nf&quot;&gt;debug&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Setting up task instance: %s&quot;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;format&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;taskModel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;taskName&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;taskModel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getTaskName&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;task&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;Util&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getObj&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;StreamTask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;taskClassName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;taskInstanceMetrics&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TaskInstanceMetrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;TaskName-%s&quot;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;format&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;taskName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;collector&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TaskInstanceCollector&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;producerMultiplexer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;taskInstanceMetrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;storeConsumers&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;changeLogSystemStreams&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;map&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;nf&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;storeName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;changeLogSystemStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;systemConsumer&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;systemFactories&lt;/span&gt;
              &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getOrElse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;changeLogSystemStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getSystem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SamzaException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Changelog system %s for store %s does not exist in the config.&quot;&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;format&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;changeLogSystemStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;storeName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)))&lt;/span&gt;
              &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getConsumer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;changeLogSystemStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getSystem&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;taskInstanceMetrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;registry&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;storeName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;systemConsumer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;toMap&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
   &lt;span class=&quot;cm&quot;&gt;/*ÁúüÊ≠£ÁöÑTaskÁîüÊàê‰∫Ü*/&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;taskInstance&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TaskInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;task&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;taskName&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;taskName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*Ëøô‰∏™Ëé∑ÂèñÁöÑÂ∞±ÊòØÈÖçÁΩÆÊñá‰ª∂‰∏≠task.classÂ£∞ÊòéÁöÑÁ±ª*/&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;taskInstanceMetrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;consumerMultiplexer&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;consumerMultiplexer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;collector&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;collector&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;offsetManager&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;offsetManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;storageManager&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;storageManager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;reporters&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reporters&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;systemStreamPartitions&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;systemStreamPartitions&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;exceptionHandler&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TaskInstanceExceptionHandler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;taskInstanceMetrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;

      &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;taskName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;taskInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}).&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;toMap&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;runÂáΩÊï∞ÔºöÂú®run‰∏≠‰∏ªË¶ÅÂºÄÂßãÂØπÊ∂àÊÅØÂºÄÂßãËΩÆËÆ≠Â§ÑÁêÜ&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;run&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Starting container.&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;cm&quot;&gt;/*ÂêØÂä®&amp;amp;ÂàùÂßãÂåñËøõÁ®ã*/&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;startMetrics&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;startOffsetManager&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;startStores&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;startProducers&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;startTask&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;startConsumers&lt;/span&gt;

      &lt;span class=&quot;nf&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Entering run loop.&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;runLoop&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*Ëøô‰∏™ÊòØÁúüÊ≠£ÁöÑËé∑ÂèñKafka‰∏≠ÁöÑÂÜÖÂÆπÔºå‰πüÂ∞±ÊòØÊàëÂÜôÁöÑprocessÂ∞±Âú®ËøôÈáå*/&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;e:&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Caught exception in process loop.&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;finally&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Shutting down.&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

      &lt;span class=&quot;n&quot;&gt;shutdownConsumers&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;shutdownTask&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;shutdownProducers&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;shutdownStores&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;shutdownOffsetManager&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;shutdownMetrics&lt;/span&gt;

      &lt;span class=&quot;nf&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Shutdown complete.&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Looper.runÂáΩÊï∞ÔºöËøô‰∏™ÊòØÁúüÊ≠£ÂêëprocessÈáåËØªÂèñÊï∞ÊçÆÁöÑÁ∫øÁ®ã&lt;/p&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;run&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nf&quot;&gt;addShutdownHook&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;currentThread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt;

    &lt;span class=&quot;nf&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(!&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shutdownNow&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;process&lt;/span&gt;  &lt;span class=&quot;cm&quot;&gt;/*ÊâæÂà∞‰∫ÜÔºåÂú®ËøôÈáå*/&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;window&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;commit&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;processÂáΩÊï∞ÔºöRunLoop.process‰ºöÊúÄÁªàË∞ÉÁî®Êàë‰ª¨ÂÜôÁöÑÂáΩÊï∞&lt;/p&gt;

&lt;div class=&quot;language-scala highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;process&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nf&quot;&gt;trace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Attempting to choose a message to process.&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;processes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;inc&lt;/span&gt;

    &lt;span class=&quot;nf&quot;&gt;updateTimer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;processMs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;envelope&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;updateTimer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;chooseMs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;consumerMultiplexer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;choose&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

      &lt;span class=&quot;nf&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;envelope&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;ssp&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;envelope&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;getSystemStreamPartition&lt;/span&gt;

        &lt;span class=&quot;nf&quot;&gt;trace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Processing incoming message envelope for SSP %s.&quot;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;format&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ssp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;envelopes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;inc&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;taskInstance&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;systemStreamPartitionToTaskInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ssp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;val&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;coordinator&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ReadableCoordinator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;taskInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;taskName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;nv&quot;&gt;taskInstance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;envelope&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;coordinator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;cm&quot;&gt;/*ÊòØ‰∏çÊòØÂæàÁÜüÊÇâ‰∫ÜÔºåÊàë‰ª¨ÂÜôÁöÑÁ®ãÂ∫èÁªà‰∫éË¢´Ë∞ÉÁî®‰∫Ü*/&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;checkCoordinator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;coordinator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nf&quot;&gt;trace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;No incoming message envelope was available.&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;nullEnvelopes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;inc&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Âà∞Ê≠§Êàë‰ª¨ÁöÑÁ®ãÂ∫èÂú®Yarn‰∏äÂ∑≤ÁªèËøêË°å‰∫Ü„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;ÁªìÊûÑ&quot;&gt;ÁªìÊûÑ&lt;/h3&gt;

&lt;p&gt;Samza is made up of three layers:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;A streaming layer. Kafka&lt;/li&gt;
  &lt;li&gt;An execution layer. YARN&lt;/li&gt;
  &lt;li&gt;A processing layer. Samza API(Áé∞Âú®ÁöÑÁêÜËß£ÊòØsamzaÂ∞±ÊòØ‰∏Ä‰∏™Â∫ìÔºåÊèê‰æõ‰∫Üapi‰ΩøkafkaËÉΩÂ§üÊï∞ÊçÆÊµÅÂ§ÑÁêÜ)&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;img src=&quot;http://samza.apache.org/img/0.13/learn/documentation/introduction/samza-ecosystem.png&quot; alt=&quot;diagram-medium&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÂíåhadoopÁöÑÊ®°ÂºèÊúâÁÇπÁõ∏‰ººÔºö&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://samza.apache.org/img/0.13/learn/documentation/introduction/samza-hadoop.png&quot; alt=&quot;diagram-medium&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÂÆòÁΩëËØ¥Samza‰∏çÂ±ÄÈôê‰∫éYARNÂíåKafkaÔºåÂ∫îËØ•Â∞±ÊåáÁöÑ‰ªñÁöÑÂèØÊèíÂÖ•ÊÄßÔºàpluggableÔºâÂêß„ÄÇ&lt;/p&gt;

&lt;p&gt;ÂÆòÁΩësamzaËøêË°åÊµÅÁ®ãÂõæÔºö&lt;/p&gt;

&lt;p&gt;clientÂêëRMÂèëÈÄÅÂºÄÂßã‰∏Ä‰∏™samza jobÁöÑËØ∑Ê±Ç
RMÊé•Êî∂ËØ∑Ê±ÇÂêë‰∏Ä‰∏™NMÂèëÈÄÅÊåá‰ª§ÔºåÂàÜÈÖçËµÑÊ∫êÔºåÂàõÂª∫‰∏Ä‰∏™AppMaster
AppMaster‰∏éRMÈÄö‰ø°ÔºåËØ∑Ê±ÇÂàõÂª∫containerË∑ëtaskÔºåRMÂêë‰∏Ä‰∏™NMÂèëÈÄÅÊåá‰ª§ÂàõÂª∫samza task runner
samza task runnerÂ∞ÜÂú®broker‰∏äÂàõÂª∫‰ªªÂä°ÔºåÂèØ‰ª•Âú®Â§ö‰∏™broker‰∏äÈù¢ÂàõÂª∫„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://samza.apache.org/img/0.13/learn/documentation/introduction/samza-yarn-kafka-integration.png&quot; alt=&quot;diagram-small&quot; /&gt;&lt;/p&gt;

&lt;p&gt;ÊØîÂ¶Ç‰∏Ä‰∏™‰æãÂ≠êÔºåSELECT user_id, COUNT(*) FROM PageViewEvent GROUP BY user_idÔºåËÆ°ÁÆóÊØè‰∏™useridÁöÑÈ°µÈù¢Êü•ÁúãÊ¨°Êï∞ÔºåÂ∞Ü‰ºöË∑ë‰∏§‰∏™‰ªªÂä°Ôºå‰∏Ä‰∏™‰ªªÂä°Ë¥üË¥£groupbyÁöÑ‰ªªÂä°ÔºåÂ∞ÜÂÖ≥ÈîÆÂ≠óËÅöÂêàÔºåÂèëÈÄÅÂêå‰∏Ä‰∏™IDÁöÑÊ∂àÊÅØÂà∞‰∏Ä‰∏™‰∏≠Èó¥topicÁöÑ‰∏Ä‰∏™ÂàÜÂå∫‰∏≠ÔºåÂè¶‰∏Ä‰∏™‰ªªÂä°Ë¥üË¥£Ê∂àË¥πtopicËøõË°åÁªüËÆ°ÔºåÁ¨¨‰∫å‰∏™‰ªªÂä°‰∏≠ÁöÑÊØè‰∏™taskÊ∂àË¥π‰∏≠Èó¥topicÁöÑ‰∏Ä‰∏™ÂàÜÂå∫ÔºåËøôÊ†∑Âª∫Á´ã‰∏Ä‰∏™ËÆ°Êï∞Âô®ÔºåËøõË°åÁªüËÆ°„ÄÇËøôÊ†∑Â∞±Á±ª‰ºº‰∫é‰∏Ä‰∏™wordcountÁöÑÂäüËÉΩ‰∫ÜÂêßÔºüÊÉ≥ÊÉ≥ÊàêÁªüËÆ°‰∏ÄÁØáÊñáÁ´†ÔºåÂ∞ÜÊâÄÊúâÁöÑÂçïËØçÊãÜÂàÜÊàê‰∏Ä‰∏™IDÔºåÊîæÂÖ•topicÁöÑpartitionÔºåËÆ©consumer‰∏≠taskÊù•ËÆ°ÁÆó„ÄÇÔºà&lt;strong&gt;Ê≥®ÊÑèjobÂíåtaskÁöÑÂå∫Âà´&lt;/strong&gt;ÔºåÁêÜËß£‰∏∫‰∏Ä‰∏™ÊòØ‰Ωú‰∏öÔºåÂåÖÂê´Â§ö‰∏™‰ªªÂä°Ôºâ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://samza.apache.org/img/0.13/learn/documentation/introduction/group-by-example.png&quot; alt=&quot;ÈáçÊñ∞ÂàíÂàÜGROUP BY&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;ÂàõÂª∫‰∏Ä‰∏™samzaÈ°πÁõÆ&quot;&gt;ÂàõÂª∫‰∏Ä‰∏™samzaÈ°πÁõÆ&lt;/h3&gt;

&lt;p&gt;ÁºñÂÜôpom.xmlÔºåÊ∑ªÂä†‰æùËµñÔºå‰ΩøÁî®mavenËøõË°åÊâìÂåÖ„ÄÇ&lt;/p&gt;

&lt;p&gt;Á§∫‰æãÔºö&lt;/p&gt;

&lt;p&gt;config.properties&lt;/p&gt;

&lt;div class=&quot;language-properties highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#Job
#ÊåáÂÆöËøêË°åÁéØÂ¢ÉÔºåÊú¨Âú∞ÊµãËØï‰ΩøÁî®ThreadJobFactoryÊàñProcessJobFactory
#job.factory.class=org.apache.samza.job.yarn.YarnJobFactory
&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;job.factory.class&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;org.apache.samza.job.local.ThreadJobFactory&lt;/span&gt;
&lt;span class=&quot;py&quot;&gt;job.name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;CountLatancy&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;#YARN
#Êú¨Âú∞ËøêË°åÊó∂ÂèØ‰ª•ÁúÅÁï•
&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;yarn.package.path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;file://{tmp}/filename.tar.gz&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#Task
#‰∏ªÁ±ªÂêçÔºåÂåÖÂêç.‰∏ªÁ±ªÂêç
&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;task.class&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;samza.CountLatancy&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#‰ΩøÁî®kafka‰Ωú‰∏∫ËæìÂÖ•ÊµÅÊó∂,Â≠óÊÆµÂê´‰πâ‰∏∫kafka.topic
&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;task.inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;kafka.clickevent&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#windowable job ÂøÖÈ°ªÈÖçÁΩÆÔºåÂçï‰Ωç‰∏∫ms
&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;task.window.ms&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;60000&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;#Serializers
#ÂÆö‰πâÂ∫èÂàóÂåñ‰∏éÂèçÂ∫èÂàóÂåñÁ±ª
&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;serializers.registry.json.class&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;org.apache.samza.serializers.JsonSerdeFactory&lt;/span&gt;
&lt;span class=&quot;py&quot;&gt;serializers.registry.string.class&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;org.apache.samza.serializers.StringSerdeFactory&lt;/span&gt;
&lt;span class=&quot;py&quot;&gt;serializers.registry.integer.class&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;org.apache.samza.serializers.IntegerSerdeFactory&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Kafka System
&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;systems.kafka.samza.factory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;org.apache.samza.system.kafka.KafkaSystemFactory&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#ËæìÂÖ•ÊµÅÁöÑÈîÆÂÄºÂ∫èÂàóÂåñÊó∂‰ΩøÁî®Âì™‰∏Ä‰∏™Â∫èÂàóÂåñÁ±ª„ÄÇ
&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;systems.kafka.samza.key.serde&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;string&lt;/span&gt;
&lt;span class=&quot;py&quot;&gt;systems.kafka.samza.msg.serde&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;string&lt;/span&gt;
&lt;span class=&quot;py&quot;&gt;systems.kafka.consumer.zookeeper.connect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;localhost:2181&lt;/span&gt;
&lt;span class=&quot;py&quot;&gt;systems.kafka.producer.bootstrap.servers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;localhost:9092&lt;/span&gt;


&lt;span class=&quot;c&quot;&gt;# Job Coordinator
&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;job.coordinator.system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;kafka&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Normally, this would be 3, but we have only one broker.
&lt;/span&gt;&lt;span class=&quot;py&quot;&gt;job.coordinator.replication.factor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;samzaDemo.java&lt;/p&gt;

&lt;div class=&quot;language-java highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;package&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;samza&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.util.HashMap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.util.Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.util.Map.Entry&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.samza.config.Config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.samza.system.IncomingMessageEnvelope&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.samza.system.OutgoingMessageEnvelope&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.samza.system.SystemStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.samza.task.InitableTask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.samza.task.MessageCollector&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.samza.task.StreamTask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.samza.task.TaskContext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.samza.task.TaskCoordinator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.samza.task.WindowableTask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.json.JSONObject&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;CountLatancy&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;StreamTask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;WindowableTask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;InitableTask&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Integer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clickEvent&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;HashMap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Integer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;();&lt;/span&gt;
    &lt;span class=&quot;nc&quot;&gt;Map&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Integer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clickCount&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;HashMap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Integer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;();&lt;/span&gt;
    &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;total&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;TOPIC_NAME&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;pageviews&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SystemStream&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stream&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SystemStream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;kafka&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;TOPIC_NAME&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;MessageCollector&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;collector&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TaskCoordinator&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;coodinator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;//int total = 0;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Entry&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Integer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;entry:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clickEvent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;entrySet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()){&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;entry&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getKey&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;latancy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;entry&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getValue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
            &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;count&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clickCount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;json&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;{\&quot;name\&quot; : \&quot;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;\&quot;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
                    &lt;span class=&quot;s&quot;&gt;&quot;,\&quot;total_latancyMs\&quot; : &quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;latancy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
                    &lt;span class=&quot;s&quot;&gt;&quot;,\&quot;clickNum\&quot; : &quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
                    &lt;span class=&quot;s&quot;&gt;&quot;,\&quot;aver_lantancyMs\&quot; : &quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;latancy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
                    &lt;span class=&quot;s&quot;&gt;&quot;}&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;total&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;collector&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;OutgoingMessageEnvelope&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;collector&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;OutgoingMessageEnvelope&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Total messages per window : &quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;total&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot; .&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;));&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;clickEvent&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;HashMap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Integer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;clickCount&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;HashMap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Integer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;IncomingMessageEnvelope&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;envelope&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;MessageCollector&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;collector&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;
            &lt;span class=&quot;nc&quot;&gt;TaskCoordinator&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;coodinator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;JSONObject&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;json&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;JSONObject&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;envelope&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getMessage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;latancy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getInt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;latancyMs&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clickEvent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;containsKey&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;())){&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;clickEvent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;put&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clickEvent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;latancy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;clickCount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;put&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clickCount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;clickEvent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;put&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;latancy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;clickCount&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;put&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nc&quot;&gt;Config&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;TaskContext&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;task&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;----------------------------------------------------------------&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
        &lt;span class=&quot;nc&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;----------------------------------------------------------------&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;pom.xml&lt;/p&gt;

&lt;div class=&quot;language-xml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;project&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://maven.apache.org/POM/4.0.0&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns:xsi=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;xsi:schemaLocation=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;modelVersion&amp;gt;&lt;/span&gt;4.0.0&lt;span class=&quot;nt&quot;&gt;&amp;lt;/modelVersion&amp;gt;&lt;/span&gt;

  &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;cn.myc&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;samzademo&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;0.0.1&lt;span class=&quot;nt&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;packaging&amp;gt;&lt;/span&gt;jar&lt;span class=&quot;nt&quot;&gt;&amp;lt;/packaging&amp;gt;&lt;/span&gt;

  &lt;span class=&quot;nt&quot;&gt;&amp;lt;name&amp;gt;&lt;/span&gt;samzademo&lt;span class=&quot;nt&quot;&gt;&amp;lt;/name&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;url&amp;gt;&lt;/span&gt;http://maven.apache.org&lt;span class=&quot;nt&quot;&gt;&amp;lt;/url&amp;gt;&lt;/span&gt;

  &lt;span class=&quot;nt&quot;&gt;&amp;lt;properties&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- maven specific properties --&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;project.build.sourceEncoding&amp;gt;&lt;/span&gt;UTF-8&lt;span class=&quot;nt&quot;&gt;&amp;lt;/project.build.sourceEncoding&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;samza.version&amp;gt;&lt;/span&gt;0.13.0&lt;span class=&quot;nt&quot;&gt;&amp;lt;/samza.version&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/properties&amp;gt;&lt;/span&gt;

  &lt;span class=&quot;nt&quot;&gt;&amp;lt;dependencies&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.samza&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;samza-api&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;${samza.version}&lt;span class=&quot;nt&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.samza&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;samza-core_2.11&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;${samza.version}&lt;span class=&quot;nt&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.samza&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;samza-log4j&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;${samza.version}&lt;span class=&quot;nt&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.samza&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;samza-shell&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;classifier&amp;gt;&lt;/span&gt;dist&lt;span class=&quot;nt&quot;&gt;&amp;lt;/classifier&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;type&amp;gt;&lt;/span&gt;tgz&lt;span class=&quot;nt&quot;&gt;&amp;lt;/type&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;${samza.version}&lt;span class=&quot;nt&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.samza&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;samza-yarn_2.11&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;${samza.version}&lt;span class=&quot;nt&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.samza&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;samza-kv_2.11&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;${samza.version}&lt;span class=&quot;nt&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.samza&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;samza-kv-rocksdb_2.11&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;${samza.version}&lt;span class=&quot;nt&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.samza&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;samza-kafka_2.11&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;${samza.version}&lt;span class=&quot;nt&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
	    &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.kafka&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
	    &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;kafka_2.11&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
    	&lt;span class=&quot;nt&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;1.0.0&lt;span class=&quot;nt&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
	  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.slf4j&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;slf4j-api&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;1.6.2&lt;span class=&quot;nt&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.slf4j&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;slf4j-log4j12&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;1.6.2&lt;span class=&quot;nt&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
	    &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.json&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
	    &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;json&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
	    &lt;span class=&quot;nt&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;20171018&lt;span class=&quot;nt&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;nt&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/dependencies&amp;gt;&lt;/span&gt;

  &lt;span class=&quot;nt&quot;&gt;&amp;lt;repositories&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;repository&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;id&amp;gt;&lt;/span&gt;my-local-repo&lt;span class=&quot;nt&quot;&gt;&amp;lt;/id&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;url&amp;gt;&lt;/span&gt;file://${user.home}/.m2/repository&lt;span class=&quot;nt&quot;&gt;&amp;lt;/url&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/repository&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;repository&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;id&amp;gt;&lt;/span&gt;apache-releases&lt;span class=&quot;nt&quot;&gt;&amp;lt;/id&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;url&amp;gt;&lt;/span&gt;https://repository.apache.org/content/groups/public&lt;span class=&quot;nt&quot;&gt;&amp;lt;/url&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/repository&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;repository&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;id&amp;gt;&lt;/span&gt;scala-tools.org&lt;span class=&quot;nt&quot;&gt;&amp;lt;/id&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;name&amp;gt;&lt;/span&gt;Scala-tools Maven2 Repository&lt;span class=&quot;nt&quot;&gt;&amp;lt;/name&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;url&amp;gt;&lt;/span&gt;https://oss.sonatype.org/content/groups/scala-tools&lt;span class=&quot;nt&quot;&gt;&amp;lt;/url&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/repository&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;repository&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;id&amp;gt;&lt;/span&gt;cloudera-repos&lt;span class=&quot;nt&quot;&gt;&amp;lt;/id&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;name&amp;gt;&lt;/span&gt;Cloudera Repos&lt;span class=&quot;nt&quot;&gt;&amp;lt;/name&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;url&amp;gt;&lt;/span&gt;https://repository.cloudera.com/artifactory/cloudera-repos/&lt;span class=&quot;nt&quot;&gt;&amp;lt;/url&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/repository&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/repositories&amp;gt;&lt;/span&gt;

  &lt;span class=&quot;nt&quot;&gt;&amp;lt;build&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;plugins&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;plugin&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.maven.plugins&lt;span class=&quot;nt&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;maven-compiler-plugin&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;3.1&lt;span class=&quot;nt&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;configuration&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;nt&quot;&gt;&amp;lt;source&amp;gt;&lt;/span&gt;1.6&lt;span class=&quot;nt&quot;&gt;&amp;lt;/source&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;nt&quot;&gt;&amp;lt;target&amp;gt;&lt;/span&gt;1.6&lt;span class=&quot;nt&quot;&gt;&amp;lt;/target&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/configuration&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;/plugin&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;plugin&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;maven-assembly-plugin&lt;span class=&quot;nt&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;2.3&lt;span class=&quot;nt&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;configuration&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;nt&quot;&gt;&amp;lt;descriptors&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;descriptor&amp;gt;&lt;/span&gt;src/main/assembly/src.xml&lt;span class=&quot;nt&quot;&gt;&amp;lt;/descriptor&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;nt&quot;&gt;&amp;lt;/descriptors&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/configuration&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;executions&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;nt&quot;&gt;&amp;lt;execution&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;id&amp;gt;&lt;/span&gt;make-assembly&lt;span class=&quot;nt&quot;&gt;&amp;lt;/id&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;phase&amp;gt;&lt;/span&gt;package&lt;span class=&quot;nt&quot;&gt;&amp;lt;/phase&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;goals&amp;gt;&lt;/span&gt;
              &lt;span class=&quot;nt&quot;&gt;&amp;lt;goal&amp;gt;&lt;/span&gt;single&lt;span class=&quot;nt&quot;&gt;&amp;lt;/goal&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;/goals&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;nt&quot;&gt;&amp;lt;/execution&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/executions&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;/plugin&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/plugins&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;/build&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/project&amp;gt;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;‰ª£Á†ÅÊòØÁªüËÆ°‰∏Ä‰∏ãÂõ∫ÂÆöÊó∂Èó¥ÊÆµÂÜÖÔºåÊØè‰∏™‰∫∫ÁÇπÂáªÊÄªÁÇπÂáªÊ¨°Êï∞ÂíåÊÄªÊó∂Âª∂„ÄÇËæìÂÖ•ÊµÅdemo‰∏∫Ôºö&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;{&quot;timestamp&quot;:&quot;2015-09-01T01:35:19Z&quot;,&quot;url&quot;:&quot;/foo&quot;,&quot;user&quot;:&quot;bob&quot;,&quot;latencyMs&quot;:66}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;ÂàõÂª∫‰∏Ä‰∏™mavenÂ∑•Á®ãÔºåÂ∑•Á®ãÁöÑÁªìÊûÑÂíåhello-samzaÁöÑÁõ∏‰ººÔºåconfigÂíåresourceÂèØ‰ª•ÁßªÊ§çËøáÊù•„ÄÇ&lt;/p&gt;

&lt;p&gt;Â∞Ü‰∏äËø∞Êñá‰ª∂ÂàõÂª∫Âπ∂Âä†ÂÖ•Âà∞Áõ∏‰ººË∑ØÂæÑ‰∏ãÔºåÊâßË°å‰∏ãËø∞ÂëΩ‰ª§Ôºö&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;src_home&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
mvn clean package
&lt;span class=&quot;nb&quot;&gt;cp &lt;/span&gt;target/target.jar &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;samza_home&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;/lib/
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;samza_home&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;tar&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-zcvf&lt;/span&gt; filename.tar.gz &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;mv &lt;/span&gt;filename.tar.gz &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;tmp&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;/
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;samza_home&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;/bin/run-job.sh &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;--config-factory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;org.apache.samza.config.factories.PropertiesConfigFactory &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;--config-path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;file://&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;samza_home&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;/config/config.properties
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Â∑•Á®ãËøêË°åÂÆåÊàê„ÄÇ&lt;/p&gt;

&lt;h3 id=&quot;Â≠¶‰π†ÊàêÊûú&quot;&gt;Â≠¶‰π†ÊàêÊûú&lt;/h3&gt;

&lt;p&gt;ÁõÆÂâçÊù•ÁúãsamzaÁöÑÁîüÊÄÅËøòÊØîËæÉÂπ¥ËΩªÔºåËêΩÂú∞ÁöÑÊÉÖÂÜµËøòÊòØÂ§™Â∞ëÔºåÁî±‰∫éËá™Â∑±Áü•ËØÜÊ†àÁöÑÁº∫Â§±ÔºåÂØπ‰∫éÂ¶Ç‰ΩïËá™Â∑±ÁºñÂÜô‰∏Ä‰∏™samzaÁöÑÁ®ãÂ∫èÂ≠òÂú®ÈóÆÈ¢òÔºåÊØîÂ¶ÇmavenÊâìÂåÖÔºåÁ§∫‰æã‰ª£Á†ÅÁõÆÂâçÊ≤°ÊúâÊãÜÂºÄËøêË°åÔºåÂØºËá¥ÂØπ‰∫éÊØè‰∏ÄÊ≠•ÁöÑÂÖ≥ÈîÆËæìÂá∫‰∏ç‰∫ÜËß£ÔºåÊï¥‰∏™‰ª£Á†ÅÁº∫Â∞ëÂøÖË¶Å‰ø°ÊÅØÁöÑ‰∫ÜËß£ÂøÖÁÑ∂ÊòØ‰∏çÂ•ΩËøõË°å‰∏ã‰∏ÄÊ≠•Â≠¶‰π†ÁöÑÔºåÁõÆÂâçÊù•ÁúãÈöæÁÇπÊúâ‰∫åÔºö&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;maven‰∏çÁÜüÊÇâ„ÄÇ&lt;/li&gt;
  &lt;li&gt;samza‰ª£Á†Å‰øÆÊîπ‰∏çÂÆπÊòìÔºå‰∏ç‰ºöÂú®ÂÖ≥ÈîÆ‰ø°ÊÅØ‰∏äËøõË°åËæìÂá∫Êü•Áúã„ÄÇ&lt;/li&gt;
  &lt;li&gt;kafkaËøô‰∏ÄÂùóÂü∫Êú¨‰∏çÊáÇÔºåÊ≤°ÊúâÂºÄÂèëËøáproducerÂíåconsumerÔºå‰∏çÁü•ÈÅìÂàÜÂ∏ÉÂºèÊ®°Âºè‰∏ãÁöÑÂ∑•‰ΩúÊú∫Âà∂&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ÊÄªÁöÑÊù•ËØ¥ÔºåsamzaÁöÑÂ≠¶‰π†ÊàêÊú¨ÂÖ∂ÂÆûËøòÊòØÊå∫È´òÁöÑÔºåÊâÄ‰ª•ËØ¥ËøôÂë®ÂÖàÊÄªÁªìÔºåËÆ©ËÄÅÂ∏àËØÑ‰ª∑‰∏Ä‰∏ãÔºåÁÑ∂ÂêéÂêßstormÊê≠Âª∫Â•ΩÔºå‰∏ÄËµ∑ËØÑ‰º∞‰∏Ä‰∏ãÔºåÊúÄÂêéÂÜ≥ÂÆöÁî®‰ªÄ‰πàÔºåÊàëËøòÊòØÊØîËæÉÂÄæÂêë‰∫éÁî®spark„ÄÇ&lt;/p&gt;
</description>
        <pubDate>Mon, 20 Nov 2017 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2017/11/20/Samza%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/11/20/Samza%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</guid>
        
        
      </item>
    
      <item>
        <title>KafkaÂ≠¶‰π†Á¨îËÆ∞</title>
        <description>&lt;h2 id=&quot;samza&quot;&gt;Samza&lt;/h2&gt;

&lt;h3 id=&quot;Á¨îËÆ∞&quot;&gt;Á¨îËÆ∞Ôºö&lt;/h3&gt;

&lt;p&gt;samzaÊòØ‰∏Ä‰∏™ÂàÜÂ∏ÉÂºèÁöÑÊµÅÂºèÊï∞ÊçÆÂ§ÑÁêÜÊ°ÜÊû∂Ôºàstreaming processingÔºâÔºåÂÆÉÊòØÂü∫‰∫éKafkaÊ∂àÊÅØÈòüÂàóÊù•ÂÆûÁé∞Á±ªÂÆûÊó∂ÁöÑÊµÅÂºèÊï∞ÊçÆÂ§ÑÁêÜÁöÑ„ÄÇ(ÂáÜÁ°ÆÁöÑËØ¥ÔºåsamzaÊòØÈÄöËøáÊ®°ÂùóÂåñÁöÑÂΩ¢ÂºèÊù•‰ΩøÁî®kafkaÁöÑÔºåÂõ†Ê≠§ÂèØ‰ª•ÊûÑÊû∂Âú®ÂÖ∂‰ªñÊ∂àÊÅØÈòüÂàóÊ°ÜÊû∂‰∏äÔºå‰ΩÜÂá∫ÂèëÁÇπÂíåÈªòËÆ§ÂÆûÁé∞ÊòØÂü∫‰∫ékafka)„ÄÇ&lt;/p&gt;

&lt;p&gt;kafkaÈõÜÁæ§Â¶ÇÊûúÊúâ‰∏Ä‰∏™Âè∞Êú∫Âô®Ê≤°ÊúâÈÄöÔºåÂæàÊúâÂèØËÉΩÊòØhostÁöÑÈóÆÈ¢ò„ÄÇ&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;kafka-topics.sh &lt;span class=&quot;nt&quot;&gt;--create&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--zookeeper&lt;/span&gt; 192.168.1.xx:2181,192.168.1.xx:2181,192.168.1.xx:2181 &lt;span class=&quot;nt&quot;&gt;--replication-factor&lt;/span&gt; 1 &lt;span class=&quot;nt&quot;&gt;--partitions&lt;/span&gt; 1 &lt;span class=&quot;nt&quot;&gt;--topic&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;kafka-topics.sh &lt;span class=&quot;nt&quot;&gt;--list&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--zookeeper&lt;/span&gt; localhost:2181
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;kafka-console-producer.sh &lt;span class=&quot;nt&quot;&gt;--broker-list&lt;/span&gt; 192.168.1.xx:9092,192.168.1.xx:9092,192.168.1.xx:9092 &lt;span class=&quot;nt&quot;&gt;--topic&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;kafka-console-consumer.sh &lt;span class=&quot;nt&quot;&gt;--zookeeper&lt;/span&gt; 192.168.1.xx:2181,192.168.1.xx:2181,192.168.1.xx:2181 &lt;span class=&quot;nt&quot;&gt;--from-beginning&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--topic&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;kafka&quot;&gt;kafka&lt;/h3&gt;

&lt;p&gt;Kafka is a distributed,partitioned,replicated commit logservice„ÄÇ&lt;/p&gt;

&lt;p&gt;kafkaÂØπÊ∂àÊÅØ‰øùÂ≠òÊó∂Ê†πÊçÆTopicËøõË°åÂΩíÁ±ªÔºåÂèëÈÄÅÊ∂àÊÅØËÄÖÊàê‰∏∫Producer,Ê∂àÊÅØÊé•ÂèóËÄÖÊàê‰∏∫Consumer„ÄÇ&lt;/p&gt;

&lt;p&gt;kafkaÈõÜÁæ§ÊúâÂ§ö‰∏™kafkaÂÆû‰æãÁªÑÊàêÔºåÊØè‰∏™ÂÆû‰æãserverÊàê‰∏∫broker„ÄÇ&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;topicÔºöÊ∂àÊÅØÂ≠òÊîæÁöÑÁõÆÂΩïÂç≥‰∏ªÈ¢ò&lt;/li&gt;
  &lt;li&gt;ProducerÔºöÁîü‰∫ßÊ∂àÊÅØÂà∞topicÁöÑ‰∏ÄÊñπ&lt;/li&gt;
  &lt;li&gt;ConsumerÔºöËÆ¢ÈòÖtopicÊ∂àË¥πÊ∂àÊÅØÁöÑ‰∏ÄÊñπ&lt;/li&gt;
  &lt;li&gt;BrokerÔºöKafkaÁöÑÊúçÂä°ÂÆû‰æãÂ∞±ÊòØ‰∏Ä‰∏™broker&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&quot;http://www.aboutyun.com/data/attachment/forum/201409/28/143553z1pif7uok8ezr61u.png&quot; alt=&quot;img&quot; /&gt;&lt;/p&gt;

&lt;p&gt;‰∏Ä‰∏™TopicÂèØ‰ª•ËÆ§‰∏∫ÊòØ‰∏ÄÁ±ªÊ∂àÊÅØÔºåÊØè‰∏™topicÂ∞ÜË¢´ÂàÜÊàêÂ§ö‰∏™partition(Âå∫)ÔºåÊØè‰∏™partitionÂú®Â≠òÂÇ®Â±ÇÈù¢ÊòØappend logÊñá‰ª∂ÔºåpartitionÂàÜÂ∏ÉÂú®‰∏çÂêåÁöÑËäÇÁÇπ‰∏≠„ÄÇ&lt;/p&gt;

&lt;p&gt;Ê∂àÊÅØÂèëÈÄÅÊó∂ÈÉΩË¢´ÂèëÈÄÅÂà∞‰∏Ä‰∏™topicÔºåÂÖ∂Êú¨Ë¥®Â∞±ÊòØ‰∏Ä‰∏™ÁõÆÂΩïÔºåËÄåtopicÁî±ÊòØÁî±‰∏Ä‰∫õPartition Logs(ÂàÜÂå∫Êó•Âøó)ÁªÑÊàê,ÂÖ∂ÁªÑÁªáÁªìÊûÑÂ¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://www.aboutyun.com/data/attachment/forum/201409/28/143553t3nhnsbri6s6nfh5.png&quot; alt=&quot;img&quot; /&gt;&lt;/p&gt;

&lt;p&gt;consumerÂèØ‰ª•‰ΩøÁî®‰ªªÊÑèÈ°∫Â∫èÊ∂àË¥πÊ∂àÊÅØÔºåÂè™ÈúÄÂ∞ÜoffsetÈáçÁΩÆ‰∏∫‰ªªÊÑèÂÄº„ÄÇ&lt;/p&gt;

&lt;p&gt;kafkaÈõÜÁæ§Âá†‰πé‰∏çÈúÄË¶ÅÁª¥Êä§‰ªª‰ΩïconsumerÂíåproducerÁä∂ÊÄÅ‰ø°ÊÅØÔºåËøô‰∫õ‰ø°ÊÅØÊúâzookeeper‰øùÂ≠ò„ÄÇ&lt;/p&gt;

&lt;p&gt;partitionsÁöÑËÆæËÆ°ÁõÆÁöÑÊúâÂ§ö‰∏™ÔºåÊúÄÊ†πÊú¨ÂéüÂõ†ÊòØkafkaÂü∫‰∫éÊñá‰ª∂Â≠òÂÇ®„ÄÇ&lt;/p&gt;

&lt;p&gt;Â∞ÜÊó•ÂøóÂÜÖÂÆπÂàÜÊï£Âà∞Â§ö‰∏™server‰∏äÔºåÈÅøÂÖçÊñá‰ª∂Â∞∫ÂØ∏ËææÂà∞ÂçïÊú∫Á£ÅÁõòÁöÑ‰∏äÈôê„ÄÇ&lt;/p&gt;

&lt;p&gt;ÊØè‰∏™partitonÈÉΩ‰ºöË¢´ÂΩìÂâçserver(kafkaÂÆû‰æã)‰øùÂ≠òÔºåÂèØ‰ª•Â∞Ü‰∏Ä‰∏™topicÂàáÂàÜÂ§ö‰ªªÊÑèÂ§ö‰∏™partitionsÔºåÊù•Ê∂àÊÅØ‰øùÂ≠ò/Ê∂àË¥πÁöÑÊïàÁéáÔºåÊ≠§Â§ñË∂äÂ§öÁöÑpartitionsÊÑèÂë≥ÁùÄÂèØ‰ª•ÂÆπÁ∫≥Êõ¥Â§öÁöÑconsumerÔºåÊúâÊïàÊèêÂçáÂπ∂ÂèëÊ∂àË¥πÁöÑËÉΩÂäõ„ÄÇ&lt;/p&gt;

&lt;p&gt;‰∏Ä‰∏™TopicÁöÑÂ§ö‰∏™partitionsÔºåË¢´ÂàÜÂ∏ÉÂú®kafkaÈõÜÁæ§‰∏≠ÁöÑÂ§ö‰∏™server‰∏äÔºõÊØè‰∏™server(kafkaÂÆû‰æã)Ë¥üË¥£partitions‰∏≠Ê∂àÊÅØÁöÑËØªÂÜôÊìç‰ΩúÔºõÊ≠§Â§ñkafkaËøòÂèØ‰ª•ÈÖçÁΩÆpartitionsÈúÄË¶ÅÂ§á‰ªΩÁöÑ‰∏™Êï∞(replicas)ÔºåÊØè‰∏™partitionÂ∞Ü‰ºöË¢´Â§á‰ªΩÂà∞Â§öÂè∞Êú∫Âô®‰∏ä,‰ª•ÊèêÈ´òÂèØÁî®ÊÄß„ÄÇ&lt;/p&gt;

&lt;p&gt;ProducersÔºöProducerÂ∞ÜÊ∂àÊÅØÂèëÂ∏ÉÂà∞ÊåáÂÆöÁöÑTopic‰∏≠ÔºåÂêåÊó∂Producer‰πüËÉΩÂÜ≥ÂÆöÂ∞ÜÊ≠§Ê∂àÊÅØÂΩíÂ±û‰∫éÂì™‰∏™partitionÔºõÊØîÂ¶ÇÂü∫‰∫é‚Äùround-robin‚ÄùÊñπÂºèÊàñËÄÖÈÄöËøáÂÖ∂‰ªñÁöÑ‰∏Ä‰∫õÁÆóÊ≥ïÁ≠â„ÄÇ&lt;/p&gt;

&lt;p&gt;ConsumersÔºöÊú¨Ë¥®‰∏äkafkaÂè™ÊîØÊåÅTopic„ÄÇÊØè‰∏™consumerÂ±û‰∫é‰∏Ä‰∏™consumer groupÔºõÂèçËøáÊù•ËØ¥,ÊØè‰∏™group‰∏≠ÂèØ‰ª•ÊúâÂ§ö‰∏™consumer„ÄÇÂèëÈÄÅÂà∞TopicÁöÑÊ∂àÊÅØÔºåÂè™‰ºöË¢´ËÆ¢ÈòÖÊ≠§TopicÁöÑÊØè‰∏™group‰∏≠ÁöÑ‰∏Ä‰∏™consumerÊ∂àË¥π„ÄÇ&lt;/p&gt;

&lt;p&gt;Â¶ÇÊûúÊâÄÊúâÁöÑconsumerÈÉΩÂÖ∑ÊúâÁõ∏ÂêåÁöÑgroupÔºåËøôÁßçÊÉÖÂÜµÂíåqueueÊ®°ÂºèÂæàÂÉè;Ê∂àÊÅØÂ∞Ü‰ºöÂú®consumers‰πãÈó¥Ë¥üËΩΩÂùáË°°„ÄÇ&lt;/p&gt;

&lt;p&gt;Â¶ÇÊûúÊâÄÊúâÁöÑconsumerÈÉΩÂÖ∑Êúâ‰∏çÂêåÁöÑgroupÔºåÈÇ£ËøôÂ∞±ÊòØ‚ÄùÂèëÂ∏É-ËÆ¢ÈòÖ‚Äù;Ê∂àÊÅØÂ∞Ü‰ºöÂπøÊí≠ÁªôÊâÄÊúâÁöÑÊ∂àË¥πËÄÖ„ÄÇ&lt;/p&gt;

&lt;p&gt;ÂØπ‰∫é‰∏Ä‰∏™topicÔºåÂêå‰∏Ä‰∏™group‰∏≠‰∏çËÉΩÊúâÂ§ö‰∫épartitions‰∏™Êï∞ÁöÑconsumerÂêåÊó∂Ê∂àË¥πÔºåÂê¶ÂàôÂ∞ÜÊÑèÂë≥ÁùÄÊüê‰∫õconsumerÂ∞ÜÊó†Ê≥ïÂæóÂà∞Ê∂àÊÅØ„ÄÇ&lt;/p&gt;

&lt;p&gt;‰∏Ä‰∏™Topic‰∏≠ÁöÑÊØè‰∏™partionsÔºåÂè™‰ºöË¢´‰∏Ä‰∏™‚ÄùËÆ¢ÈòÖËÄÖ‚Äù‰∏≠ÁöÑ‰∏Ä‰∏™consumerÊ∂àË¥πÔºå‰∏çËøá‰∏Ä‰∏™consumerÂèØ‰ª•Ê∂àË¥πÂ§ö‰∏™partitions‰∏≠ÁöÑÊ∂àÊÅØ„ÄÇ&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://www.aboutyun.com/data/attachment/forum/201409/28/143554ypkap9sc5cu2j993.png&quot; alt=&quot;img&quot; /&gt;&lt;/p&gt;

&lt;p&gt;‚Äã    Êú¨Ë¥®‰∏äkafkaÂè™ÊîØÊåÅTopic.ÊØè‰∏™consumerÂ±û‰∫é‰∏Ä‰∏™consumer group;ÂèçËøáÊù•ËØ¥,ÊØè‰∏™group‰∏≠ÂèØ‰ª•ÊúâÂ§ö‰∏™consumer.ÂèëÈÄÅÂà∞TopicÁöÑÊ∂àÊÅØ,Âè™‰ºöË¢´ËÆ¢ÈòÖÊ≠§TopicÁöÑÊØè‰∏™group‰∏≠ÁöÑ‰∏Ä‰∏™consumerÊ∂àË¥π.&lt;/p&gt;
</description>
        <pubDate>Sun, 19 Nov 2017 20:00:00 +0800</pubDate>
        <link>http://localhost:4000/2017/11/19/Kafka%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</link>
        <guid isPermaLink="true">http://localhost:4000/2017/11/19/Kafka%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</guid>
        
        <category>ÂàÜÂ∏ÉÂºè</category>
        
        <category>Ê°ÜÊû∂</category>
        
        
      </item>
    
  </channel>
</rss>
